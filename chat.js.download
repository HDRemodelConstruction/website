var Handlebars=((typeof Handlebars)!==undefined&&(typeof Handlebars)!=="undefined")?Handlebars:(function(){var j=(function(){var b;function a(c){this.string=c}a.prototype.toString=function(){return""+this.string};b=a;return b})();var m=(function(c){var b={};var v=c;var a={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};var y=/[&<>"'`]/g;var u=/[&<>"'`]/;function z(n){return a[n]||"&amp;"}function d(n,o){for(var p in o){if(o.hasOwnProperty(p)){n[p]=o[p]}}}b.extend=d;var w=Object.prototype.toString;b.toString=w;var x=function(n){return typeof n==="function"};if(x(/x/)){x=function(n){return typeof n==="function"&&w.call(n)==="[object Function]"}}var x;b.isFunction=x;var e=Array.isArray||function(n){return(n&&typeof n==="object")?w.call(n)==="[object Array]":false};b.isArray=e;function f(n){if(n instanceof v){return n.toString()}else{if(!n&&n!==0){return""}}n=""+n;if(!u.test(n)){return n}return n.replace(y,z)}b.escapeExpression=f;function t(n){if(!n&&n!==0){return true}else{if(e(n)&&n.length===0){return true}else{return false}}}b.isEmpty=t;return b})(j);var l=(function(){var b;var a=["description","fileName","lineNumber","message","name","number","stack"];function c(){var d=Error.prototype.constructor.apply(this,arguments);for(var e=0;e<a.length;e++){this[a[e]]=d[a[e]]}}c.prototype=new Error();b=c;return b})();var k=(function(a,F){var G={};var c=a;var e=F;var D="1.1.2";G.VERSION=D;var B=4;G.COMPILER_REVISION=B;var y={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:">= 1.0.0"};G.REVISION_CHANGES=y;var d=c.isArray,z=c.isFunction,A=c.toString,C="[object Object]";function f(o,n){this.helpers=o||{};this.partials=n||{};b(this)}G.HandlebarsEnvironment=f;f.prototype={constructor:f,logger:H,log:x,registerHelper:function(p,o,n){if(A.call(p)===C){if(n||o){throw new e("Arg not supported with multiple helpers")}c.extend(this.helpers,p)}else{if(n){o.not=n}this.helpers[p]=o}},registerPartial:function(n,o){if(A.call(n)===C){c.extend(this.partials,n)}else{this.partials[n]=o}}};function b(n){n.registerHelper("helperMissing",function(o){if(arguments.length===2){return undefined}else{throw new Error("Missing helper: '"+o+"'")}});n.registerHelper("blockHelperMissing",function(o,p){var r=p.inverse||function(){},q=p.fn;if(z(o)){o=o.call(this)}if(o===true){return q(this)}else{if(o===false||o==null){return r(this)}else{if(d(o)){if(o.length>0){return n.helpers.each(o,p)}else{return r(this)}}else{return q(o)}}}});n.registerHelper("each",function(t,u){var w=u.fn,r=u.inverse;var p=0,o="",q;if(z(t)){t=t.call(this)}if(u.data){q=E(u.data)}if(t&&typeof t==="object"){if(d(t)){for(var s=t.length;p<s;p++){if(q){q.index=p;q.first=(p===0);q.last=(p===(t.length-1))}o=o+w(t[p],{data:q})}}else{for(var v in t){if(t.hasOwnProperty(v)){if(q){q.key=v}o=o+w(t[v],{data:q});p++}}}}if(p===0){o=r(this)}return o});n.registerHelper("if",function(o,p){if(z(o)){o=o.call(this)}if((!p.hash.includeZero&&!o)||c.isEmpty(o)){return p.inverse(this)}else{return p.fn(this)}});n.registerHelper("unless",function(o,p){return n.helpers["if"].call(this,o,{fn:p.inverse,inverse:p.fn,hash:p.hash})});n.registerHelper("with",function(o,p){if(z(o)){o=o.call(this)}if(!c.isEmpty(o)){return p.fn(o)}});n.registerHelper("log",function(p,q){var o=q.data&&q.data.level!=null?parseInt(q.data.level,10):1;n.log(o,p)})}var H={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(o,n){if(H.level<=o){var p=H.methodMap[o];if(typeof console!=="undefined"&&console[p]){console[p].call(console,n)}}}};G.logger=H;function x(o,n){H.log(o,n)}G.log=x;var E=function(n){var o={};c.extend(o,n);return o};G.createFrame=E;return G})(m,l);var g=(function(c,A,w){var a={};var d=c;var f=A;var x=w.COMPILER_REVISION;var u=w.REVISION_CHANGES;function y(o){var p=o&&o[0]||1,r=x;if(p!==r){if(p<r){var q=u[r],n=u[p];throw new Error("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+q+") or downgrade your runtime to an older version ("+n+").")}else{throw new Error("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+o[1]+").")}}}function b(q,n){if(!n){throw new Error("No environment passed to template")}var o;if(n.compile){o=function(I,K,G,t,H,s){var J=z.apply(this,arguments);if(J){return J}var r={helpers:t,partials:H,data:s};H[K]=n.compile(I,{data:s!==undefined},n);return H[K](G,r)}}else{o=function(s,r){var t=z.apply(this,arguments);if(t){return t}throw new f("The partial "+r+" could not be compiled when running in runtime-only mode")}}var p={escapeExpression:d.escapeExpression,invokePartial:o,programs:[],program:function(s,r,C){var t=this.programs[s];if(C){t=e(s,r,C)}else{if(!t){t=this.programs[s]=e(s,r)}}return t},merge:function(r,s){var t=r||s;if(r&&s&&(r!==s)){t={};d.extend(t,s);d.extend(t,r)}return t},programWithDepth:v,noop:B,compilerInfo:null};return function(G,E){E=E||{};var t=E.partial?E:n,s,r;if(!E.partial){s=E.helpers;r=E.partials}var F=q.call(p,t,G,s,r,E.data);if(!E.partial){y(p.compilerInfo)}return F}}a.template=b;function v(p,o,n){var q=Array.prototype.slice.call(arguments,3);var r=function(s,t){t=t||{};return o.apply(this,[s,t.data||n].concat(q))};r.program=p;r.depth=q.length;return r}a.programWithDepth=v;function e(q,p,o){var n=function(r,s){s=s||{};return p(r,s.data||o)};n.program=q;n.depth=0;return n}a.program=e;function z(r,p,t,s,o,n){var q={partial:true,helpers:s,partials:o,data:n};if(r===undefined){throw new f("The partial "+p+" could not be found")}else{if(r instanceof Function){return r(t,q)}}}a.invokePartial=z;function B(){return""}a.noop=B;return a})(m,l,k);var h=(function(b,z,w,f,c){var a;var y=b;var v=z;var t=w;var d=f;var u=c;var e=function(){var n=new y.HandlebarsEnvironment();d.extend(n,y);n.SafeString=v;n.Exception=t;n.Utils=d;n.VM=u;n.template=function(o){return u.template(o,n)};return n};var x=e();x.create=e;a=x;return a})(k,j,l,m,g);return h})();function _chatnox_debug_log(b){try{if(_chatnox_log.debug){console.log(b)}}catch(a){}}typeof Object.create!="function"&&(Object.create=function(d){function c(){}c.prototype=d;return new c}),!function(g){var f=g.snack={},k=0,j=Object.prototype.toString,h=Array.prototype.indexOf;f.extend=function(){if(arguments.length==1){return f.extend(f,arguments[0])}var b=arguments[0];for(var n,m=1,l=arguments.length;m<l;m++){for(n in arguments[m]){b[n]=arguments[m][n]}}return b},f.extend({v:"1.2.1",bind:function(e,d,l){return function(){return e.apply(d,l||arguments)}},punch:function(b,o,n,m){var l=b[o];b[o]=m?function(){l.apply(b,arguments);return n.apply(b,arguments)}:function(){var a=[].slice.call(arguments,0);a.unshift(f.bind(l,b));return n.apply(b,a)}},create:function(b,l){var e=Object.create(b);if(!l){return e}for(i in l){if(!l.hasOwnProperty(i)){continue}if(!b[i]||typeof l[i]!="function"){e[i]=l[i];continue}f.punch(e,i,l[i])}return e},id:function(){return ++k},each:function(m,l,q){if(m.length===void 0){for(var p in m){m.hasOwnProperty(p)&&l.call(q,m[p],p,m)}return m}for(var o=0,n=m.length;o<n;o++){l.call(q,m[o],o,m)}return m},parseJSON:function(a){if(typeof a=="string"){a=a.replace(/^\s+|\s+$/g,"");var l=/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""));if(!l){throw"Invalid JSON"}var e=g.JSON;return e&&e.parse?e.parse(a):(new Function("return "+a))()}},isArray:function(b){return b instanceof Array||j.call(b)=="[object Array]"},indexOf:h?function(d,c){return h.call(c,d)}:function(l,e){for(var n=0,m=e.length;n<m;n++){if(e[n]===l){return n}}return -1}})}(window),!function(f,e){var h={},g;f.wrap=function(a,k){typeof a=="string"&&(a=g(a,k)),a.length||(a=[a]);var j=Object.create(h),d=0,c=a.length;for(;d<c;d++){j[d]=a[d]}j.length=c,j.id=f.id();return j},f.extend(f.wrap,{define:function(a,c){if(typeof a!="string"){for(i in a){f.wrap.define(i,a[i])}}else{h[a]=c}},defineEngine:function(b){g=b}}),f.wrap.defineEngine(function(b,d){typeof d=="string"&&(d=e.querySelector(d));return(d||e).querySelectorAll(b)})}(snack,document),!function(z,y,x){function o(){try{r.doScroll("left")}catch(b){setTimeout(o,50);return}p("poll")}function p(a){if(a.type!="readystatechange"||x.readyState=="complete"){(a.type=="load"?y:x)[v](u+a.type,p,!1),!t&&(t=!0)&&z.each(q,function(b){b.apply(x)})}}var w=x.addEventListener?"addEventListener":"attachEvent",v=x.addEventListener?"removeEventListener":"detachEvent",u=x.addEventListener?"":"on",t=!1,s=!0,r=x.documentElement,q=[];z.extend({stopPropagation:function(b){b.stopPropagation?b.stopPropagation():b.cancelBubble=!0},preventDefault:function(b){b.preventDefault?b.preventDefault():b.returnValue=!1}}),z.listener=function(a,d){a.delegate&&(a.capture=!0,_handler=d,d=function(h){var g=h.target||h.srcElement,b=typeof a.delegate=="string"?z.wrap(a.delegate,a.node):a.delegate(a.node);while(g&&z.indexOf(g,b)==-1){g=g.parentNode}g&&g!==this&&g!==x&&_handler.call(g,h,g)}),a.context&&(d=z.bind(d,a.context));var c={attach:function(){a.node[w](u+a.event,d,a.capture)},detach:function(){a.node[v](u+a.event,d,a.capture)},fire:function(){d.apply(a.node,arguments)}};c.attach();return c},z.ready=function(b){t?b.apply(x):q.push(b)};if(x.createEventObject&&r.doScroll){try{s=!y.frameElement}catch(n){}s&&o()}x[w](u+"DOMContentLoaded",p,!1),x[w](u+"readystatechange",p,!1),y[w](u+"load",p,!1)}(snack,window,document),!function(b){b.publisher=function(a){var d={};a=a||{},b.extend(a,{subscribe:function(c,l,k){var j={fn:l,ctxt:k||{}};d[c]||(d[c]=[]);var h={attach:function(){d[c].push(j)},detach:function(){d[c].splice(b.indexOf(l,d[c]),1)}};h.attach();return h},publish:function(c,e){if(!d[c]){return !1}b.each(d[c],function(f){f.fn.apply(f.ctxt,e||[])});return d[c].length}});return a},b.publisher(b)}(snack),!function(g,f,k){function h(){}g.JSONP=function(a,o){var n="jsonp"+g.id(),m=k.createElement("script"),l=!1;g.JSONP[n]=function(d){l=!1,delete g.JSONP[n],o(d)},typeof a.data=="object"&&(a.data=g.toQueryString(a.data));var c={send:function(){l=!0,m.src=a.url+"?"+a.key+"=snack.JSONP."+n+"&"+a.data,k.getElementsByTagName("head")[0].appendChild(m)},cancel:function(){l&&m.parentNode&&m.parentNode.removeChild(m),l=!1,g.JSONP[n]=function(){delete g.JSONP[n]}}};a.now!==!1&&c.send();return c},g.toQueryString=function(a,l){var e=[];g.each(a,function(c,n){l&&(n=l+"["+n+"]");var m;switch(g.isArray(c)){case"object":m=g.toQueryString(c,n);break;case"array":var d={};g.each(c,function(p,o){d[o]=p}),m=g.toQueryString(d,n);break;default:m=n+"="+encodeURIComponent(c)}c!==null&&e.push(m)});return e.join("&")};var j=function(){var l=function(){return new XMLHttpRequest},e=function(){return new ActiveXObject("MSXML2.XMLHTTP")},n=function(){return new ActiveXObject("Microsoft.XMLHTTP")};try{l();return l}catch(m){try{e();return e}catch(m){n();return n}}}();g.request=function(a,l){if(!(this instanceof g.request)){return new g.request(a,l)}var d=this;d.options=g.extend({},d.options,a),d.callback=l,d.xhr=new j,d.headers=d.options.headers,d.options.now!==!1&&d.send()},g.request.prototype={options:{exception:h,url:"",data:"",method:"get",now:!0,headers:{"X-Requested-With":"XMLHttpRequest",Accept:"text/javascript, text/html, application/xml, text/xml, */*"},async:!0,emulation:!0,urlEncoded:!0,encoding:"utf-8"},onStateChange:function(){var l=this,e=l.xhr;if(e.readyState==4&&!!l.running){l.running=!1,l.status=0;try{var o=e.status;l.status=o==1223?204:o}catch(n){}e.onreadystatechange=h;var m=l.status>=200&&l.status<300?[!1,l.xhr.responseText||"",l.xhr.responseXML]:[l.status];l.callback.apply(l,m)}},setHeader:function(d,c){this.headers[d]=c;return this},getHeader:function(d){try{return this.xhr.getResponseHeader(d)}catch(c){return null}},send:function(){var u=this,t=u.options;if(u.running){return u}u.running=!0;var s=t.data||"",r=String(t.url),q=t.method.toLowerCase();typeof s!="string"&&(s=g.toQueryString(s));if(t.emulation&&g.indexOf(q,["get","post"])<0){var p="_method="+q;s=s?p+"&"+s:p,q="post"}if(t.urlEncoded&&g.indexOf(q,["post","put"])>-1){var o=t.encoding?"; charset="+t.encoding:"";u.headers["Content-type"]="application/x-www-form-urlencoded"+o}r||(r=k.location.pathname);var n=r.lastIndexOf("/");n>-1&&(n=r.indexOf("#"))>-1&&(r=r.substr(0,n)),s&&q=="get"&&(r+=(r.indexOf("?")>-1?"&":"?")+s,s=null);var c=u.xhr;c.open(q.toUpperCase(),r,open.async,t.user,t.password),t.user&&"withCredentials" in c&&(c.withCredentials=!0),c.onreadystatechange=g.bind(u.onStateChange,u);for(i in u.headers){try{c.setRequestHeader(i,u.headers[i])}catch(a){t.exception.apply(u,[i,u.headers[i]])}}c.send(s),t.async||u.onStateChange();return u},cancel:function(){var d=this;if(!d.running){return d}d.running=!1;var c=d.xhr;c.abort(),c.onreadystatechange=h,d.xhr=new j;return d}}}(snack,window,document),!function(f,e){function g(a,m,l,k){var j=a.data(l);j&&f.each(j,function(b){b[m].apply(a,k)});return a}function h(b){return b.replace(/\s+/g," ").replace(/^\s+|\s+$/g,"")}f.wrap.define({data:function(){var b={};return function(a,k){var j=b[this.id];j||(j=b[this.id]={});if(k===void 1){return j[a]}return j[a]=k}}(),each:function(a,d){return f.each(this,a,d)},addClass:function(b){return this.each(function(a){h(a.className).indexOf(b)>-1||(a.className=h(a.className+" "+b))})},removeClass:function(b){return this.each(function(a){a.className=a.className.replace(new RegExp("(^|\\s)"+b+"(?:\\s|$)"),"$1")})},attach:function(a,m,l){var k=a.split("."),j=[];k[1]&&(j=this.data(k[1])||[]),this.each(function(c){var d={node:c,event:k[0]};l&&(d.delegate=l),j.push(f.listener(d,m))}),k[1]&&this.data(k[1],j);return this},detach:function(b){g(this,"detach",b,null,!0),this.data(b,null);return this},fire:function(d,c){return g(this,"fire",d,c)},delegate:function(j,d,k){return this.attach(j,k,d)}})}(snack,document),!function(aY,aX){function ab(f){var e=[],h,g;label:for(h=0;h<f.length;h++){for(g=0;g<e.length;g++){if(e[g]==f[h]){continue label}}e[e.length]=f[h]}return e}function ac(b,f){var e=typeof f=="string"?ac(f)[0]:f||aX;if(!e||!b){return[]}if(aR=ae(b,f,ac)){return aR}if(aX.getElementsByClassName&&(aR=b.match(aA))){return ar(e.getElementsByClassName(aR[1]))}return ar(e.querySelectorAll(b))}function ad(b){return b===window||b&&b.nodeType&&b.nodeType.toString().match(/[19]/)}function ae(b,h,g){var f=typeof h=="string"?g(h)[0]:h||aX;if(ad(b)){return !h||ad(f)&&af(b,f)?[b]:[]}if(b&&typeof b=="object"&&isFinite(b.length)){return ar(b)}if(aR=b.match(aB)){return(aM=aX.getElementById(aR[1]))?[aM]:[]}if(aR=b.match(az)){return ar(f.getElementsByTagName(aR[1]))}return !1}function ag(f){var e=[],m=[],l,k,j=am.g(f)||am.s(f,f.split(aw));j=j.slice(0);if(!j.length){return e}e=aj(j);if(!j.length){return e}for(aU=0,k=e.length,aT=0;aU<k;aU++){aL=e[aU],aP=aL;for(l=j.length;l--;){az:while(aP!==ax&&(aP=aP.parentNode)){if(aJ=ak.apply(aP,al(j[l]))){break az}}}aJ&&(m[aT++]=aL)}return m}function ah(e,d,f){switch(e){case"=":return d==f;case"^=":return d.match(an.g("^="+f)||an.s("^="+f,new RegExp("^"+ai(f))));case"$=":return d.match(an.g("$="+f)||an.s("$="+f,new RegExp(ai(f)+"$")));case"*=":return d.match(an.g(f)||an.s(f,new RegExp(ai(f))));case"~=":return d.match(an.g("~="+f)||an.s("~="+f,new RegExp("(?:^|\\s+)"+ai(f)+"(?:\\s+|$)")));case"|=":return d.match(an.g("|="+f)||an.s("|="+f,new RegExp("^"+ai(f)+"(-|$)")))}return !1}function ai(b){return ao.g(b)||ao.s(b,b.replace(/([.*+?\^=!:${}()|\[\]\/\\])/g,"\\$1"))}function aj(r){var q=[],p=r.pop(),o=al(p),n=o[1]||"*",m,l,h,b=r.length&&(aR=r[0].match(aB))?aX.getElementById(aR[1]):aX;if(!b){return q}h=b.getElementsByTagName(n);for(m=0,l=h.length;m<l;m++){aM=h[m],(aH=ak.apply(aM,o))&&q.push(aH)}return q}function ak(u,t,s,r,q,p,o){var n,m,d;if(t&&this.tagName.toLowerCase()!==t){return !1}if(s&&(n=s.match(aD))&&n[1]!==this.id){return !1}if(s&&(aI=s.match(aC))){for(aV=aI.length;aV--;){m=aI[aV].slice(1);if(!(ap.g(m)||ap.s(m,new RegExp("(^|\\s+)"+m+"(\\s+|$)"))).test(this.className)){return !1}}}if(r&&!o){aQ=this.attributes;for(d in aQ){if(Object.prototype.hasOwnProperty.call(aQ,d)&&(aQ[d].name||d)==q){return this}}}if(r&&!ah(p,this.getAttribute(q)||"",o)){return !1}return this}function al(b){return b.match(at)}function ar(b){aO=[];for(aV=0,aK=b.length;aV<aK;aV++){aO[aV]=b[aV]}return aO}var aW,aV,aU,aT,aS,aR,aQ,aP,aO,aN,aM,aL,aK,aJ,aI,aH,aG,aF,aE,aD=/#([\w\-]+)/,aC=/\.[\w\-]+/g,aB=/^#([\w\-]+$)/,aA=/^\.([\w\-]+)$/,az=/^([\w\-]+)$/,ay=/^([\w]+)?\.([\w\-]+)$/,ax=aX.documentElement,aw=/\s(?![\s\w\-\/\?\&\=\:\.\(\)\!,@#%<>\{\}\$\*\^'"]*\])/,av=/^([a-z0-9]+)?(?:([\.\#]+[\w\-\.#]+)?)/,au=/\[([\w\-]+)(?:([\|\^\$\*\~]?\=)['"]?([ \w\-\/\?\&\=\:\.\(\)\!,@#%<>\{\}\$\*\^]+)["']?)?\]/,at=new RegExp(av.source+"("+au.source+")?"),aq=function(){this.c={}};aq.prototype={g:function(b){return this.c[b]||undefined},s:function(d,c){this.c[d]=c;return c}};var ap=new aq,ao=new aq,an=new aq,am=new aq,af="compareDocumentPosition" in ax?function(d,c){return(c.compareDocumentPosition(d)&16)==16}:"contains" in ax?function(d,c){return c!==d&&c.contains(d)}:function(d,c){while(d=d.parentNode){if(d===c){return 1}}return 0},aa=function(){if(aX.querySelector&&aX.querySelectorAll){return ac}return function(r,q){var p=typeof q=="string"?aa(q)[0]:q||aX;if(!p||!r){return[]}var o,n,k=[],h=[],e;if(aR=ae(r,q,aa)){return aR}if(aR=r.match(ay)){aG=p.getElementsByTagName(aR[1]||"*"),aO=ap.g(aR[2])||ap.s(aR[2],new RegExp("(^|\\s+)"+aR[2]+"(\\s+|$)"));for(o=0,n=aG.length,aU=0;o<n;o++){aO.test(aG[o].className)&&(k[aU++]=aG[o])}return k}for(o=0,aG=r.split(","),n=aG.length;o<n;o++){h[o]=ag(aG[o])}for(o=0,n=h.length;o<n&&(aE=h[o]);o++){var b=aE;if(p!==aX){b=[];for(aU=0,aR=aE.length;aU<aR&&(e=aE[aU]);aU++){af(e,p)&&b.push(e)}}k=k.concat(b)}return ab(k)}}();aa.uniq=ab;var Z=aY.qwery;aa.noConflict=function(){aY.qwery=Z;return this},aY.qwery=aa}(this,document),snack.qwery=qwery.noConflict(),snack.wrap.defineEngine(function(d,c){return snack.qwery(d,c)});var _ChatNox_Config=_ChatNox_Config||{app_url:document.location.protocol+"//"+((location.host.indexOf("localhost")!=-1)?"localhost:8888":((_chatnox.version)?(_chatnox.version+".chatnoxapp.appspot.com"):((document.location.protocol!="https")?"app.chatnox.com":"app.chatnox.com"))),stickybar_prefs:"",widget_prefs:"",visitor_image:"",window_image:"https://s3.amazonaws.com/chatnox/avatars/1413096407559-CS.png",sound_path:"",set_prefs:function(){this.visitor_image=_ChatNox_Config.app_url+"/img/flat-smiley.png";this.sound_path=_ChatNox_Config.app_url+"/site/sounds/visitor.mp3"},company_logo:"https://www.chatnox.com/assets/chatnox-widget-logo-250.png"};var _ChatNox_Js_Api=_ChatNox_Js_Api||{};_ChatNox_Js_Api.hide_bar=function(){document.body.appendChild(_ChatNox_Templates.get_template("hide-bar",{hide_bar:true}))};_ChatNox_Js_Api.hide_grabber=function(){document.body.appendChild(_ChatNox_Templates.get_template("hide-bar",{hide_grabber:true}))};_ChatNox_Js_Api.call_api=function(){try{_ChatNox_Js_Api.on_after_load()}catch(a){_chatnox_debug_log(a)}};_ChatNox_Js_Api.on_event_fired=function(b,c){try{try{_ChatNox_Js_Api.on_event_fired_callback(b,c)}catch(a){}switch(b){case"ONLINE_CHAT_INITIATED":_ChatNox_Js_Api.on_online_chat(c);break;case"OFFLNE_CHAT_INITIATED":_ChatNox_Js_Api.on_offline_chat(c);break;default:break}}catch(a){_chatnox_debug_log(a)}};var _ChatNox_auto_pilot=_ChatNox_auto_pilot||{timer:"",time:30,mssg:"Please hold while the chat is connected to an available operator. If you do-not wish to wait, click here to leave us a message.",link:"",start:function(){if(_ChatNox_Config.widget_prefs.customMessages&&_ChatNox_Config.widget_prefs.customMessages.auto_pilot_mssg){_ChatNox_auto_pilot.mssg=_ChatNox_Config.widget_prefs.customMessages.auto_pilot_mssg;_ChatNox_auto_pilot.link=_ChatNox_Config.widget_prefs.customMessages.auto_pilot_link_text;if(_ChatNox_Config.widget_prefs.customMessages.auto_pilot_time){_ChatNox_auto_pilot.time=_ChatNox_Config.widget_prefs.customMessages.auto_pilot_time}}this.show_loader();this.timer=setTimeout(function(){_ChatNox_auto_pilot.stop();if(_ChatNox_auto_pilot.link){_ChatNox_Window.append_message("["+_ChatNox_auto_pilot.mssg+"<br><a href='javascript: void(0);' onclick='_ChatNox_Chat_Ui.show_offline();'>"+_ChatNox_auto_pilot.link+"</a>]","no-escape")}else{_ChatNox_Window.append_message("[<a href='javascript: void(0);' onclick='_ChatNox_Chat_Ui.show_offline();'>"+_ChatNox_auto_pilot.mssg+"</a>]","no-escape")}},(_ChatNox_auto_pilot.time*1000))},show_loader:function(){_ChatNox_Events.query("#chatnox-chats-container").addClass("in_queue")},hide_loader:function(){_ChatNox_Events.query("#chatnox-chats-container").removeClass("in_queue")},stop:function(){if(this.timer){clearTimeout(this.timer)}}};function chatnox_replace_regex_symbols_with_values(c){if(!c){return c}if(c.indexOf("%visitor_name%")>=0){var a=_ChatNox_Misc.get_visitor_prefs("text");if(!a){a="Me"}var b=new RegExp("%visitor_name%","g");c=c.replace(b,a)}var b=new RegExp("\r\n","g");c=c.replace(b,"<br>");return c}function chatnox_get_custom_message_from_prefs(c,a){var b=_ChatNox_Config.widget_prefs.customMessages;if(!b||!b[c]){return a}return chatnox_replace_regex_symbols_with_values(b[c])}var _ChatNox_Templates={get_template:function(e,b,a){if(!e){return""}try{if(!a&&!b.no_escape){b=_ChatNox_XSS.escape_json_values(b)}var c=Handlebars.templates["chatnox-"+e];return this.convert_to_html(c(b))}catch(d){_chatnox_debug_log(d)}return""},convert_to_html:function(b){var e=document.createDocumentFragment(),c=document.createElement("body"),d,a;c.innerHTML=b;while(d=c.firstChild){e.appendChild(d)}a=e;e=c=null;return a}};(function(){Handlebars.registerHelper("chatnox_increase_val",function(b,a){return(parseInt(b)+parseInt(a))});Handlebars.registerHelper("chatnox_equal",function(b,a,c){if(b==a){return c.fn(this)}else{return c.inverse(this)}});Handlebars.registerHelper("chatnox_visitor_name",function(a){return _ChatNox_Misc.get_visitor_prefs("text")});Handlebars.registerHelper("chatnox_visitor_image",function(b){var a=_ChatNox_Misc.get_visitor_prefs("email");if(!a){return _ChatNox_Config.visitor_image}return"https://secure.gravatar.com/avatar/"+MessageDigest(a)+"?d="+_ChatNox_Config.visitor_image});Handlebars.registerHelper("chatnox_agent_prefs",function(a,b){if(!_ChatNox_session.agent_json){return""}return _ChatNox_session.agent_json[a]});Handlebars.registerHelper("chatnox_time_ago",function(b,a){if(!b){return""}return _ChatNox_Timeago_Blinker.get_formatted_time(b)});Handlebars.registerHelper("chatnox_message",function(b,a){return _ChatNox_Misc.parse_anchor_tags(b)});Handlebars.registerHelper("chatnox-ref-url",function(c,b){var a="utm_source=chat-widget&utm_medium=widget&utm_term=widget&utm_content=Referring Traffic from Widget&utm_campaign=widget virality";c=(!c||typeof c!="string")?"https://www.chatnox.com/":c;if(c.indexOf("chatnox.com")<0){a=""}return c+"?"+a});Handlebars.registerHelper("chatnox_sound_prefs",function(a){return _ChatNox_Window_Chat_Sound.get_state()});Handlebars.registerHelper("get_grabber_presence",function(){var a=_ChatNox_Prefs.get_prefs(_ChatNox_Chat_Ui.chat_grabber_closed);return(a=="closed")?"none":"block"});Handlebars.registerHelper("chatnox-stickybar-status",function(){var a=_ChatNox_Prefs.get_prefs(_ChatNox_Web_Stickybars.sticky_bar_status);return(a=="closed")?"closed":"open"});Handlebars.registerHelper("chatnox_is_window_popup",function(a){if(_ChatNox_Client_APP.is_mobile_optimized()){return a.fn(this)}else{return a.inverse(this)}});Handlebars.registerHelper("chatnox_contains_word",function(b,c,a){if(!b||!c){return a.fn(this)}if(b.toLowerCase().indexOf(c.toLowerCase())!=-1){return a.fn(this)}else{return a.inverse(this)}});Handlebars.registerHelper("chatnox_brand_source",function(a){try{var b=Handlebars.templates["chatnox-brand-container"];return b(_ChatNox_Config.widget_prefs)}catch(c){}});Handlebars.registerHelper("chatnox_get_custom_message",function(c,b,a){return chatnox_get_custom_message_from_prefs(c,b)});Handlebars.registerHelper("chatnox_get_default_values",function(a,b){if(!_ChatNox_session.agent_json||!_ChatNox_session.agent_json[a]){_chatnox_debug_log(a+" : "+Chanox_Default_Globals[a]);return Chanox_Default_Globals[a]}return _ChatNox_session.agent_json[a]});Handlebars.registerHelper("get_user_company_logo",function(a,b){return _ChatNox_Config.company_logo});Handlebars.registerHelper("get_user_theme_color",function(a){return _ChatNox_Config.widget_prefs.themePrefs.widget_theme_color_code});Handlebars.registerHelper("show_operator_title",function(a){var b=_ChatNox_Config.widget_prefs;if(b.group_status=="online"){return(b.onlinePrefs.show_operator_title)?a.fn(this):a.inverse(this)}return(b.offlinePrefs.show_operator_title)?a.fn(this):a.inverse(this)});Handlebars.registerHelper("chatnox_app_url",function(a){return _ChatNox_Config.app_url});Handlebars.registerHelper("chatnox_format_bytes",function(a){return _ChatNox_Misc.format_bytes(a,2)});Handlebars.registerHelper("is_status_online",function(a){return(_ChatNox_Config.widget_prefs.group_status=="online")?a.fn(this):a.inverse(this)});Handlebars.registerHelper("is_rating_enabled",function(a){return(_ChatNox_Config.widget_prefs.onlinePrefs.show_ratings)?a.fn(this):a.inverse(this)});Handlebars.registerHelper("is_message_file_type",function(b,a){return(chatnox_is_message_file_type(b))?a.fn(JSON.parse(b)):a.inverse(this)})})();var _ChatNox_Inbound={handle_message:function(e){var d=e.type;if(!d){return}_chatnox_debug_log(e);if(d=="CHAT_ACCEPTED"){if(_ChatNox_session.agent_json&&_ChatNox_session.agent_json.id!=e.operator.id){_ChatNox_GA.push_event("chat_transfered",e.operator.name)}_ChatNox_auto_pilot.hide_loader();_ChatNox_session.agent_json=e.operator;_ChatNox_Prefs.set_prefs(_ChatNox_session.session_cookie,e.session_id);_ChatNox_Chat_Ui.window_title();_ChatNox_GA.push_event("chat_served",_ChatNox_session.agent_json.name);ChatNox_File_Attach.toggle_file_upload_option("show");_ChatNox_Visitor_Activity.setStatusToServing()}else{if(d=="NEW_MSSG"){var b=e.new_message;if(!b){return}_ChatNox_Window.append_message(b,"OPERATOR");_ChatNox_Window_Blinker.blink_with_message(b)}else{if(d=="CHAT_CLOSED"){_ChatNox_session.close_session("OPERATOR");_ChatNox_typing_pings.remove_typing_alert(e.session_id);_ChatNox_GA.push_event("chat_closed_by_"+e.closed_by.toLowerCase(),"-")}else{if(d=="VISITOR_IP_BLOCKED"){var a=chatnox_get_custom_message_from_prefs("blocked_visitor_mssg"," [Your IP has been blocked.]");_ChatNox_Window.append_message(a,"SYSTEM")}else{if(d=="TYPING_ALERT"){var c=e.session_id;if(!c){return}_ChatNox_typing_pings.handle_typing_alert(e)}}}}}if(d!="TYPING_ALERT"&&d!="CHAT_CLOSED"){if(d!="CHAT_ACCEPTED"){_ChatNox_Misc.play_sound("new_message")}_ChatNox_auto_pilot.stop()}}};var _ChatNox_Requester=_ChatNox_Requester||{construct_json_callback_request:function(c,a){if(c){c.callback="?"}var e="";for(var b in c){var d=c[b];if(d&&typeof d!="string"){continue}d=(b=="callback")?d:encodeURIComponent(d);e+=b+"="+d+"&"}a=(a.indexOf("/")==0)?(_ChatNox_Config.app_url+a):a;a=((a.indexOf("?")==-1)?a+"?":a+"&")+e;return((a.lastIndexOf("&")!=a.length-1)?a:a.slice(0,a.length-1))},send_jsonp_request:function(a,b,c){this.request_JSONP(this.construct_json_callback_request(b,a),function(d){if(c){c(d)}})},request_JSONP:function(a,c){var b="json"+(Math.random()*100).toString().replace(/\./g,"");window[b]=function(d){c&&c(d)};document.getElementsByTagName("body")[0].appendChild((function(){var d=document.createElement("script");d.type="text/javascript";d.src=a.replace("callback=?","callback="+b);return d})())}};var ChatNox_Pusher_Obj_Visitor=ChatNox_Pusher_Obj_Visitor||{pusher_ref:"",pusher_token:"chatNoxpushertoken",cloud_file:"https://d3dy5gmtp8yhk7.cloudfront.net/2.2.0/pusher.min.js",k:"30fcb22749a3791f9308",forced_chat:"forced_chat",options:function(){return{disableStats:true,encrypted:true}},visitor_options:function(){return{visitor_info:ChatNox_Pusher_Obj_Visitor.info()}},info:function(){var d={},e=_ChatNox_Misc.visitor_info();var c=_ChatNox_Prefs.get_prefs(_ChatNox_session.visitor_prefs);if(c){e.form_fields=c}var b=_ChatNox_Config.widget_prefs;var a=b.date;if(a){e.date=a}e.title=document.title;e.language=navigator.languages?navigator.languages[0]:(navigator.language||navigator.userLanguage);d.group_id=_ChatNox_Client_APP.get_account();d.visitor_info=JSON.stringify(e);d.visitorId=this.visitor_token();_chatnox_debug_log(d);return d},visitor_token:function(){var a=_ChatNox_Prefs.get_prefs(this.pusher_token);if(a){return a}a=(!a)?new Date().getTime():a;_ChatNox_Prefs.set_prefs(this.pusher_token,a);return a},subscribe:function(){if(this.pusher_ref){return}var a=_ChatNox_Config.widget_prefs;_ChatNox_Util.load_js(ChatNox_Pusher_Obj_Visitor.cloud_file,function(){var b=a.parent_key+"-"+_ChatNox_Client_APP.get_account()+"-"+ChatNox_Pusher_Obj_Visitor.visitor_token();ChatNox_Pusher_Obj_Visitor.pusher_ref=new Pusher(ChatNox_Pusher_Obj_Visitor.k,ChatNox_Pusher_Obj_Visitor.options());if(a.parent_key==6691428320673792||a.parent_key===5341593334972416){return}pusher_channel=ChatNox_Pusher_Obj_Visitor.pusher_ref.subscribe(b);pusher_channel.bind("pusher:subscription_succeeded",function(c){var d=ChatNox_Pusher_Obj_Visitor.info();d.user_key=b.split("-")[0];_ChatNox_Requester.send_jsonp_request(_ChatNox_Config.app_url+"/client/pusher/add-visitor",d,function(e){})});pusher_channel.bind("client-event",function(c){ChatNox_Pusher_Obj_Visitor.response_cbk(c)})})},response_cbk:function(b){var c=_ChatNox_session.get_session();if(c){return}_ChatNox_Chat_Ui.fire_click("#chatnox-widget-bar");_ChatNox_Chat_Ui.show_chat_session();var a={};a.message=b.message;a.from="OPERATOR";var d={};d.image=b.image;d.name=b.agent_name;d.role=b.designation;_ChatNox_Chat_Ui.show_agent_info(d);_ChatNox_Window.add_to_window("system-message",a);_ChatNox_Prefs.set_prefs(ChatNox_Pusher_Obj_Visitor.forced_chat,"OPERATOR_INITIATED");_ChatNox_Misc.play_sound("force_chat");_ChatNox_Window_Blinker.blink_with_message(b.message)}};var _ChatNox_session=_ChatNox_session||{visitor_messages:new Array(),session_cookie:"chatNox_client_session",client_id_cookie:"chatNox_client_id",visitor_prefs:"visitor_prefs",agent_json:"",get_archive_session:function(){var a=_ChatNox_Prefs.get_prefs(this.client_id_cookie);if(!a){return}_ChatNox_Socket.create_channel(JSON.parse(a).clientId);_ChatNox_Requester.send_jsonp_request("/client/client-chat/archive/"+this.get_session(),{url:encodeURIComponent(document.location.href)},function(b){_chatnox_debug_log(b);if(b.status!="success"){_ChatNox_session.close_session();_ChatNox_Chat_Ui.open_window_on_status();return}if(b.operator){_ChatNox_session.agent_json=b.operator;_ChatNox_Chat_Ui.window_title();ChatNox_File_Attach.toggle_file_upload_option("show")}_ChatNox_Window.refresh_window(b.archive)})},check_session:function(c){var b=this.get_session();_chatnox_debug_log(b);if(!b){ChatNox_File_Attach.toggle_file_upload_option();var a=_ChatNox_Prefs.get_prefs(_ChatNox_Chat_Ui.chat_bar_opened_cookie);if(!a){_ChatNox_Chat_Ui.show_bar();if(c){_ChatNox_Trigger_Message.fire()}return}_ChatNox_Chat_Ui.open_window_on_status();return}this.get_archive_session();_ChatNox_Chat_Ui.show_chat_session()},get_session:function(){return _ChatNox_Prefs.get_prefs(this.session_cookie)},send_message:function(d,a){_ChatNox_Window.reset_chat_box();var b=this.get_session();if(!b){if(this.visitor_messages.length>0){this.visitor_messages.push(d);return}this.visitor_messages.push(d);this.create_session(d,a);return}var c={};c.session_id=b;c.message=d;_ChatNox_Requester.send_jsonp_request("/client/client-chat/message",c,function(e){_chatnox_debug_log(e)})},create_session:function(b,a){_chatnox_debug_log("chat_type = "+a);_ChatNox_Socket.req_client_id(function(){var d=_ChatNox_Prefs.get_prefs(_ChatNox_session.client_id_cookie);_chatnox_debug_log(d);var h={};h.dept_id=_ChatNox_Misc.get_selected_group_id("online");h.message=b;h.token=JSON.parse(d).clientId;h.chat_type=(a)?a:"TRIGGERED";var j=_ChatNox_Prefs.get_prefs(ChatNox_Pusher_Obj_Visitor.forced_chat);if(j){h.chat_type=j}if(a){_ChatNox_GA.push_event(a?"proactive_chat_started":"chat_started","-")}var c=_ChatNox_Misc.visitor_info();var f="";if(a!="TRIGGERED"){try{f=_chatnox_serialize_form("chatnox-widget-online-form")}catch(g){}}else{f=_ChatNox_Prefs.get_prefs(_ChatNox_session.visitor_prefs);f=(f)?JSON.parse(f):f}if(f){c.form_fields=f}if(_ChatNox_Trigger_Message.triggered_mssg_prefs){c.trigger_mssg=_ChatNox_Trigger_Message.triggered_mssg_prefs.message}h.visitor_info=JSON.stringify(c);_ChatNox_Prefs.set_prefs(_ChatNox_session.visitor_prefs,JSON.stringify(f));_ChatNox_Requester.send_jsonp_request("/client/client-chat/start",h,function(k){_chatnox_debug_log(k);if(k.status!="success"){var e=k.message;if(!k.type||k.type!="VISITOR_IP_BLOCKED"){e+="<a href='javascript: void(0);' onclick='_ChatNox_Chat_Ui.show_offline();'> Leave a offline message</a>."}_ChatNox_Window.append_message(e,"no-escape");_ChatNox_session.close_session("OPERATOR");return}_ChatNox_auto_pilot.start();_ChatNox_Prefs.set_prefs(_ChatNox_session.session_cookie,k.response.session_id);_ChatNox_session.send_visitor_messages()})})},send_visitor_messages:function(){if(this.visitor_messages.length==0){return}var b=this.visitor_messages.length;for(var a=0;a<b;a++){var c=this.visitor_messages.shift();if(a==0){continue}this.send_message(c)}},close_session:function(b){if(!b){var a=this.get_session();if(a){_ChatNox_Requester.send_jsonp_request("/client/client-chat/close/"+a,{},function(c){_chatnox_debug_log(c)})}}_ChatNox_Prefs.delete_prefs(_ChatNox_session.session_cookie);_ChatNox_Prefs.delete_prefs(this.client_id_cookie);_ChatNox_Socket.close();_ChatNox_session.agent_json=null;_ChatNox_Chat_Ui.window_title();_ChatNox_Prefs.delete_prefs(_ChatNox_Window_Chat_Rating.current_rate);_ChatNox_Window_Chat_Rating.rate_chat(0);_ChatNox_auto_pilot.stop();this.visitor_messages=new Array();ChatNox_File_Attach.toggle_file_upload_option();_ChatNox_Visitor_Activity.setStatusToActive()},ask_confirmation_and_close:function(){var a=_ChatNox_session.get_session();if(!a){return this.end_chat()}var b="Are you sure you want to end this chat session ?";if(_ChatNox_Config.widget_prefs.customMessages&&_ChatNox_Config.widget_prefs.customMessages.alert_when_visitor_closed){b=_ChatNox_Config.widget_prefs.customMessages.alert_when_visitor_closed}if(window.confirm(b)){this.end_chat()}},end_chat:function(){_ChatNox_auto_pilot.hide_loader();_ChatNox_session.close_session();_ChatNox_Prefs.delete_prefs(_ChatNox_Chat_Ui.chat_bar_opened_cookie);_ChatNox_Prefs.delete_prefs(ChatNox_Pusher_Obj_Visitor.forced_chat);_ChatNox_Chat_Ui.show_bar();var a=_ChatNox_Events.query("#chatnox-widget")[0];a.className=_ChatNox_Chat.replace_string(a.className,"chatnox-closed")+" chatnox-closed";_ChatNox_Chat_Ui.show_live_chat_button(true)}};var _ChatNox_Socket=_ChatNox_Socket||{js_path:(_chatnox.debug)?"https://app.chatnox.com/lib/socket.io.js":"https://app.chatnox.com/lib/socket.io.js",socket:false,create_channel:function(a,b){if(!a){return}this.close();_ChatNox_Socket.load_channel_js(function(){_ChatNox_Socket.socket=io.connect((_chatnox.debug)?"https://notifications.chatnox.com:443/PubSubIO":"https://notifications.chatnox.com:443/PubSubIO",{transports:["websocket"],upgrade:false});_ChatNox_Socket.socket.on("connect",function(){_chatnox_debug_log("onopen");_ChatNox_Prefs.set_prefs(_ChatNox_session.client_id_cookie,JSON.stringify({token:a,clientId:_ChatNox_Socket.socket.id}));if(_ChatNox_session.get_session()){_ChatNox_Requester.send_jsonp_request("/client/client-chat/update_uuid/"+_ChatNox_session.get_session()+"?uuid="+_ChatNox_Socket.socket.id,{},function(c){if(b){b()}});return}if(b){b()}});_ChatNox_Socket.socket.on("onMessage",function(c){_chatnox_debug_log("onmessage");_ChatNox_Socket.on_message(c)});_ChatNox_Socket.socket.on("disconnect",function(){_chatnox_debug_log("Close")})})},on_message:function(a){_chatnox_debug_log("on_message");a=JSON.parse(JSON.parse(a).data);try{_ChatNox_Inbound.handle_message(a)}catch(b){_chatnox_debug_log(b)}},close:function(){if(!this.socket){return}this.socket.close()},load_channel_js:function(a){try{if(typeof goog.appengine=="object"){if(a){a()}return}throw new Error()}catch(b){_chatnox_debug_log(b);_ChatNox_Util.load_js(_ChatNox_Socket.js_path,function(){if(a){a()}})}},req_client_id:function(b){var a=_ChatNox_Misc.get_selected_group_id("online");_ChatNox_Socket.create_channel(a,b)}};var _ChatNox_Trigger_Message=_ChatNox_Trigger_Message||{trigger_prefs_cookie:"triggers",trigger_session_cookie:"trigger_session",timer:"",triggered:false,triggered_mssg_prefs:null,clear_timer:function(){if(this.timer){clearTimeout(this.timer)}},fire:function(){if(_ChatNox_Config.widget_prefs.group_status=="offline"){return}this.get_trigger(function(a){if(!a){return}_ChatNox_Trigger_Message.trigger_message(a,a.time_to_popup)});_ChatNox_Visitor_Activity.setStatusToTriggered()},get_filtered_trigger:function(c){if(!c){return null}c=JSON.parse(c);if(typeof c==="string"){c=JSON.parse(c)}c=_ChatNox_Trigger_Conditions.get_matched_rules(c);c=_ChatNox_Trigger_Conditions.sort_by_key(c,"wildcard");c=_ChatNox_Trigger_Conditions.sort_by_key(c,"visitor_type");_ChatNox_Trigger_Conditions.set_visit_type(c);for(var a=0;a<c.length;a++){var b=c[a];if(_ChatNox_Trigger_Conditions.url_parse(b)&&_ChatNox_Trigger_Conditions.country(b)&&_ChatNox_Trigger_Conditions.visit_type(b)){return b}}return null},get_trigger:function(d){var c=_ChatNox_Prefs.get_prefs(this.trigger_prefs_cookie);var b=_ChatNox_Config.widget_prefs.rules_updated;var a=_ChatNox_Prefs.read_cookie(this.trigger_session_cookie);if(a&&c&&c!=null&&!b){return d(this.get_filtered_trigger(c))}_ChatNox_Requester.send_jsonp_request("/client/website/triggers/"+_ChatNox_Config.widget_prefs.parent_key,{},function(e){var f=JSON.stringify(e);_ChatNox_Prefs.set_prefs(_ChatNox_Trigger_Message.trigger_prefs_cookie,f);_ChatNox_Prefs.create_cookie(_ChatNox_Trigger_Message.trigger_session_cookie,true);return d(_ChatNox_Trigger_Message.get_filtered_trigger(f))})},trigger_message:function(a,c){if(!a){return}if(c){this.timer=setTimeout("_ChatNox_Trigger_Message.trigger_message("+JSON.stringify(a)+")",(parseInt(c)*1000));return}try{a=JSON.parse(a)}catch(b){}_ChatNox_Chat_Ui.fire_click("#chatnox-widget-bar");_ChatNox_Chat_Ui.show_chat_session();_ChatNox_Events.query("#chatnox-widget-bar")[0].click();_ChatNox_Chat_Ui.show_chat_session();setTimeout(function(){_ChatNox_typing_pings.remove_typing_alert();_ChatNox_Window.add_to_window("system-message",a)},4000);_ChatNox_Window.add_to_window("typing-message",{});this.triggered=true;this.triggered_mssg_prefs=a;_ChatNox_Misc.play_sound("trigger");_ChatNox_GA.push_event("proactive_triggered","-")}};var _ChatNox_Trigger_Conditions={type:"return_visit",match_urls:function(a,b){if(!a||!b||a.toLowerCase()=="all"||b.toLowerCase()=="all"){return true}a=a.replace(/\?/g,"/");b=b.replace(/\?/g,"/");a=a.replace(/\/$/,"");b=b.replace(/\/$/,"");if(b.indexOf("*")==-1){return(a==b)}var c=b.replace(/\*/g,"<");c=c.replace(/</g,"[a-zA-Z0-9\\-\\:\\%\\?\\&\\=_./#]*");_chatnox_debug_log(a+" : "+b);return !(a.match(c)==null)},url_parse:function(a){if(!a){return false}return this.match_urls(document.location.href,a.wildcard)},exclude_page_url:function(a){if(!a||!a.exclude_pages){return false}var c=a.exclude_pages;if(c){for(var b=0;b<c.length;b++){if(this.match_urls(document.location.href,c[b])){return true}}}return},visit_type:function(c){if(!c){return false}if(!this.url_parse(c)){return false}var a=_ChatNox_Prefs.get_prefs(c.wildcard+this.type);var b=c.visitor_type;return(!b||b.toLowerCase()=="all")?true:(a==b)},country:function(b){if(!b){return false}var d=_ChatNox_Config.widget_prefs.visitor_geo.country_code;if(!d){return true}d=d.toUpperCase();var e=b.incl_countries;if(e){for(var c=0;c<e.length;c++){if(e[c]==d){return true}}}var a=b.excl_countries;if(a){for(var c=0;c<a.length;c++){if(a[c]==d){return false}}}return true},set_visit_type:function(h){var j={};for(var c=0;c<h.length;c++){var e=h[c];if(!this.url_parse(e)){continue}var f=e.wildcard;j[f]=f}for(var g in j){var a=g+this.type;var d=_ChatNox_Prefs.get_prefs(a);var b=(d==null)?"new_visitor":"returning";_ChatNox_Prefs.create_cookie(a,b)}},get_matched_rules:function(d){var c=[],b={};for(var a=0;a<d.length;a++){var e=d[a];if(!this.url_parse(e)||this.exclude_page_url(e)){continue}c.push(e)}return c},sort_by_key:function(b,a){return b.sort(function(e,d){var c=e[a];var f=d[a];if(a=="wildcard"){return((c==f)?(e.created_on<d.created_on?1:0):(((c.length<f.length)?1:0)))}else{if(a=="visitor_type"){if(e.wildcard!=d.wildcard){return -1}return(((c==f)?-1:((f=="returning"||(f=="new_visitor"&&c=="all"))?1:0)))}}})}};var _ChatNox_Visitor_Activity=_ChatNox_Visitor_Activity||{idleTimer:null,idleTime:10000,startIdleTimer:function(){this.idleTimer=setTimeout(function(){_ChatNox_Visitor_Activity.setStatusToInactive()},this.idleTime)},resetIdleTimer:function(){this.idleTimer=null;this.setStatusToActive()},setStatusToActive:function(){this.updateVisitorStatus("ACTIVE")},setStatusToInactive:function(){this.updateVisitorStatus("INACTIVE")},setStatusToTriggered:function(){this.updateVisitorStatus("TRIGGERED")},setStatusToServing:function(){this.updateVisitorStatus("SERVING")},setStatusToClickedChatBar:function(){this.updateVisitorStatus("CLICKED_CHAT_BAR")},updateVisitorStatus:function(a){var b={status:a,visitorId:ChatNox_Pusher_Obj_Visitor.visitor_token()};_ChatNox_Requester.send_jsonp_request(_ChatNox_Config.app_url+"/client/pusher/update-visitor-status",b)}};var _ChatNox_XSS=_ChatNox_XSS||{escape_html:function(a){try{if(chatnox_is_message_file_type(a)){try{a=JSON.parse(val)}catch(b){}return a}a=a.replace(/&amp;/g,"&");return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}catch(b){}return a},escape_json_values:function(a){if(!a){return}for(key in a){a[key]=this.escape_html(a[key])}return a}};function chatnox_is_message_file_type(b){if(!b||!isNaN(b)){return false}try{b=JSON.parse(b);return true}catch(a){}return false}var _ChatNox_Window_Blinker={timer:"",original_title:document.title,blink_with_message:function(b,a){if(!b){return}_chatnox_debug_log("blink_title = "+b);a=(a===undefined)?true:a;if(a){document.title=b}else{document.title=this.original_title}this.clear_timer();this.timer=setTimeout("_ChatNox_Window_Blinker.blink_with_message('"+b+"', "+!a+")",800)},clear_timer:function(){if(this.timer){clearTimeout(this.timer)}}};document.onfocusin=_chatnox_window_focus;window.onfocus=_chatnox_window_focus;function _chatnox_window_focus(){_ChatNox_Window_Blinker.clear_timer();document.title=_ChatNox_Window_Blinker.original_title}var ChatNox_File_Attach={import_file:function(a,e,d){var b=a.files;var c=a.id;if(!b){file=[];file.push({name:a.value.substring(a.value.lastIndexOf("\\")+1),size:0,type:a.value.substring(a.value.lastIndexOf(".")+1)})}_chatnox_debug_log("file");_chatnox_debug_log(b);this.construct_form_with_file_data(a,b,c,e,d);a.value=""},construct_form_with_file_data:function(l,a,c,h,j){if(!a||a.length==0){return}for(var g=0;a.length>g;g++){var e=a[g];if(!e||!e.name){continue}if(!e.size){j("Sorry, File size not detected.","Please use a different browser",e);continue}var k=e.name;var b=k.split(".").pop();if(!b||b.indexOf("exe")==0){j("Sorry, you cannot send such files.",undefined,e);continue}if(e.size<100){j("Sorry, file size should be atleast 100 bytes.",undefined,e);continue}if(e.size>2000000){j("Sorry, you cannot send files larger than 2 MB.",undefined,e);continue}var f="uploads/";e.file_resource=f+new Date().getTime()+"-"+k.replace(/ /g,"");this.toggle_process_logo("show");var d=this.construct_form_data(e);d.append("file",e);e.id=c;this.execute_amazon_upload(d,e,h,j)}},construct_form_data:function(b){var a=new FormData();a.append("key",b.file_resource);a.append("acl","public-read");a.append("AWSAccessKeyId","AKIAJ6P4X66AUOTOLEJA");a.append("policy","ewogICJleHBpcmF0aW9uIjogIjIwMjAtMDEtMDFUMTI6MDA6MDAuMDAwWiIsCiAgImNvbmRpdGlvbnMiOiBbCiAgICB7ImJ1Y2tldCI6ICJjaGF0bm94IiB9LAogICAgeyJhY2wiOiAicHVibGljLXJlYWQiIH0sCiAgICBbInN0YXJ0cy13aXRoIiwgIiRrZXkiLCAidXBsb2Fkcy8iXSwKICAgIFsiY29udGVudC1sZW5ndGgtcmFuZ2UiLCAwLCAyMDAwMDAwXQogIF0KfQo=");a.append("signature","qe7Bckhm8tD+m/3nTifsr/YmrbU=");return a},execute_amazon_upload:function(c,a,e,d){var b=new window.XMLHttpRequest();b.upload.addEventListener("progress",function(f){ChatNox_File_Attach.upload_progress(f,a)},false);b.addEventListener("load",function(f){ChatNox_File_Attach.upload_complete(f,a,e)},false);b.addEventListener("error",function(f){ChatNox_File_Attach.upload_failed(f,a,d)},false);b.addEventListener("abort",function(f){ChatNox_File_Attach.upload_canceled(f,a,d)},false);b.open("POST","https://chatnox.s3.amazonaws.com/",true);b.send(c)},upload_progress:function(a,b){if(a.lengthComputable){var c=Math.round(a.loaded*100/a.total)}else{}},upload_complete:function(a,c,d){if(!c||!c.file_resource){return}var b="https://s3.amazonaws.com/chatnox/"+c.file_resource;_chatnox_debug_log(b);d(b,c)},upload_failed:function(a,b,c){c("Error in uploading image. ","Check your internet connection",b);_chatnox_debug_log("There was an error attempting to upload the file.");return},upload_canceled:function(a,b,c){c("Error in uploading image. ","Check your internet connection",b);return},toggle_file_upload_option:function(a){var b=document.getElementById("chatnox_widget_file_attach_icon");if(a=="show"&&_ChatNox_Config.widget_prefs.user_plan!="free"){if(_ChatNox_Config.widget_prefs.onlinePrefs.show_file_attachment){b.style.display="inline-block"}}else{b.style.display="none"}},toggle_process_logo:function(a){_chatnox_debug_log("type = "+a);if(a=="show"){document.getElementById("chatnox_widget_file_attach_icon").style.display="none";document.getElementById("chatnox_widget_file_attach_loader").style.display="inline-block"}else{document.getElementById("chatnox_widget_file_attach_icon").style.display="inline-block";document.getElementById("chatnox_widget_file_attach_loader").style.display="none"}},file_upload_success:function(a,b){_chatnox_debug_log("file_upload_success");_chatnox_debug_log(a);ChatNox_File_Attach.toggle_process_logo("hide");var c={};c.type="upload";c.name=b.name;c.size=b.size;c.path=a;c=JSON.stringify(c);_ChatNox_Window.append_message(c,"VISITOR");_ChatNox_session.send_message(c)},file_upload_error:function(a,c,b){_chatnox_debug_log("file_upload_success");ChatNox_File_Attach.toggle_process_logo("hide");_ChatNox_Window.append_message("["+a+"]","SYSTEM")}};var _ChatNox_GA={category:"ChatNox Livechat",labels:{bubble_clicked:"Chat-Bar Clicked",proactive_triggered:"Proactive Message Triggered",chat_started:"Chat Initiated",proactive_chat_started:"Proactive Chat Initiated",chat_served:"Chat Answered",chat_closed_by_operator:"Chat Closed by Operator",chat_closed_by_visitor:"Chat Closed by Visitor",chat_closed_by_timed_out:"Chat Timed-Out",offline_message:"Offline Message Sent",chat_transfered:"Chat Transferred",twitter:"Twitter Clicked",facebook:"Facebook Clicked",rated_good:"Chat Rated Good",rated_bad:"Chat Rated Bad",},get_label_for_action:function(a){if(this.labels[a]){return this.labels[a]}return"-"},is_valid_to_push:function(){var a=_ChatNox_Config.widget_prefs.googleAnalyticsSync;if(a&&!a.grant_ga_integration){return false}return true},push_event:function(b,d){if(!this.is_valid_to_push()){return}var a=this.get_label_for_action(b);try{_gaq.push(["_trackEvent",this.category,a,d])}catch(c){try{ga("send","event",this.category,a,d)}catch(c){}}}};var _ChatNox_Grabbers={start:function(){setInterval(function(){var d="chatnox-bounce";var a=_ChatNox_Config.widget_prefs.group_status,b;if(a=="offline"){b=_ChatNox_Config.widget_prefs.offlinePrefs}else{b=_ChatNox_Config.widget_prefs.onlinePrefs}if(b.grabberPrefs.grabber_animation){d="chatnox-"+b.grabberPrefs.grabber_animation}var c=_ChatNox_Events.query("#chatnox-profile-line")[0];c.className=_ChatNox_Chat.replace_string(c.className,d);setTimeout(function(){c.className=_ChatNox_Chat.replace_string(c.className,d)+" "+d},100)},60000)}};(function(){_ChatNox_Grabbers.start()})();var _ChatNox_Prefs={get_account:function(){return _ChatNox_Client_APP.get_account()},create_cookie:function(c,d,e){c=this.get_account()+"-"+c;if(e){var b=new Date();b.setTime(b.getTime()+(e*24*60*60*1000));var a="; expires="+b.toGMTString()}else{var a=""}document.cookie=c+"="+escape(d)+a+"; path=/"},erase_cookie:function(a){this.create_cookie(a,"",-1)},read_cookie:function(b){b=this.get_account()+"-"+b;var e=b+"=";var a=document.cookie.split(";");for(var d=0;d<a.length;d++){var f=a[d];while(f.charAt(0)==" "){f=f.substring(1,f.length)}if(f.indexOf(e)==0){return unescape(f.substring(e.length,f.length))}}return null},get_prefs:function(b){var a=this.read_cookie(b);b=this.get_account()+"-"+b;if(!a&&typeof(localStorage)){try{a=localStorage.getItem(b)}catch(c){}}return a},set_prefs:function(a,c,d){if(!d&&typeof(localStorage)){try{localStorage.setItem(this.get_account()+"-"+a,c)}catch(b){this.create_cookie(a,c,d)}}else{this.create_cookie(a,c,d)}},delete_prefs:function(a){if(typeof(localStorage)){try{localStorage.removeItem(this.get_account()+"-"+a)}catch(b){}}this.erase_cookie(a)}};var _ChatNox_Window_Chat_Rating={current_rate:"chat_rate",init_handlers:function(){var a=_ChatNox_Events.query(".chatnox-dropdown-menu-rating-option div");for(var b=0;b<a.length;b++){_ChatNox_Window_Chat_Rating.rate_init_click(a[b])}var c=_ChatNox_Events.query("#chatnox-widget-like-option");for(var b=0;b<c.length;b++){_ChatNox_Window_Chat_Rating.rate_init_click(c[b])}c=_ChatNox_Events.query("#chatnox-widget-dislike-option");for(var b=0;b<c.length;b++){_ChatNox_Window_Chat_Rating.rate_init_click(c[b])}},rate_init_click:function(a){a.onclick=function(){try{var g=_ChatNox_session.get_session();if(!g||g.indexOf("ChatNox")>-1){return}var c=a.className;if(c.indexOf("chatrating-active")!=-1){return false}else{var b=_ChatNox_Events.query("#chatnox-widget-like-option, #chatnox-widget-dislike-option");for(var d=0;d<b.length;d++){c=b[d].className;if(a.id==b[d].id){c+=" chatrating-active"}else{c=c.replace("chatrating-active","").trim()}b[d].className=c}}}catch(f){}_ChatNox_Window_Chat_Rating.rate_chat(a.getAttribute("rel"));_ChatNox_GA.push_event("rated_"+a.getAttribute("rel").toLowerCase(),"-")}},clear_ratings:function(){},toogle_rating_option:function(d){var a=_ChatNox_Events.query("#chatnox-widget-like-option, #chatnox-widget-dislike-option");for(var b=0;b<a.length;b++){try{var c=a[b].className;if(a[b].getAttribute("rel")==d){c+=" chatrating-active"}else{c=c.replace("chatrating-active","").trim()}a[b].className=c}catch(f){}}},rate_chat:function(e,a){e=(!e)?0:e;if(a||!e){this.toogle_rating_option(e);return}if(this.get_chat_rating()==e){return}_ChatNox_Prefs.set_prefs(this.current_rate,e);var c=_ChatNox_session.get_session();if(!c||c.indexOf("ChatNox")>-1){return}var b="You rated our customer service as "+e;if(_ChatNox_Config.widget_prefs.customMessages){if(e=="Good"){b=_ChatNox_Config.widget_prefs.customMessages.when_rated_good}else{b=_ChatNox_Config.widget_prefs.customMessages.when_rated_bad}}_ChatNox_Window.append_message("["+b+"]","SYSTEM");var d={};d.session_id=c;_ChatNox_Requester.send_jsonp_request("/client/client-chat/chat-rate/"+e,d,function(f){_chatnox_debug_log(f)})},get_chat_rating:function(){var a=_ChatNox_Prefs.get_prefs(this.current_rate);return(!a)?0:a}};function _chatnox_serialize_form(a){var e=new Array();var b=_ChatNox_Events.query("#"+a+" input");for(var d=0;d<b.length;d++){var c=b[d];if(c.type=="button"||c.type=="submit"){continue}var f={};f.type=_ChatNox_Events.ele_type(c);f.name=c.placeholder;f.value=c.value.trim();if(c.getAttribute("id").indexOf("custom")!=-1){f.field_type="custom"}e.push(f)}return e}var _ChatNox_Social={get_user_tweets:function(){_ChatNox_Requester.send_jsonp_request("/client/client-chat/social/twitter/"+_ChatNox_Config.widget_prefs.parent_key,{},function(a){_ChatNox_Social.handle_twitter_tweets(a)})},relative_time:function(c){c=new Date(c)+"";var b=c.split(" ");c=b[1]+" "+b[2]+", "+b[5]+" "+b[3];var a=Date.parse(c);var d=(arguments.length>1)?arguments[1]:new Date();var e=parseInt((d.getTime()-a)/1000);e=e+(d.getTimezoneOffset()*60);if(e<60){return"less than a minute ago"}else{if(e<120){return"about a minute ago"}else{if(e<(60*60)){return(parseInt(e/60)).toString()+" minutes ago"}else{if(e<(120*60)){return"about an hour ago"}else{if(e<(24*60*60)){return"about "+(parseInt(e/3600)).toString()+" hours ago"}else{if(e<(48*60*60)){return"1 day ago"}else{return(parseInt(e/86400)).toString()+" days ago"}}}}}}},handle_twitter_tweets:function(h){var a=document.createElement("script");a.type="text/javascript";a.src="https://platform.twitter.com/widgets.js";try{document.getElementsByTagName("body")[0].appendChild(a)}catch(j){}if(!h||h.lenght==0){_ChatNox_Events.query("#chatnox-widget-social-content")[0].innerHTML="<div style='font-size: 12px;margin-left: 10px;margin-top: 10px;'>No tweets...</div>";return}var c=[];for(var g=0;g<h.length;g++){var f=h[g].user.screenName;var b="",d="";var l=h[g].retweetedStatus,k="";k=(l)?l:h[g];f=k.user.screenName;b=k.user.profileImageUrlHttps;d=h[g].text.replace(/((https?|s?ftp|ssh)\:\/\/[^"\s\<\>]*[^.,;'">\:\s\<\>\)\]\!])/g,function(e){e=e.replace("http://","https://");return'<a style="text-decoration: none;" target="_blank" href="'+e+'" >'+e+"</a>"}).replace(/\B@([_a-z0-9]+)/ig,function(e){return e.charAt(0)+'<a style="text-decoration: none;display:inline;" target="_blank" href="https://twitter.com/'+e.substring(1)+'"> '+e.substring(1)+"</a>"});c.push('<div class="chatnox-tweet"><div class="tweet-entry-header"><a href="javascript: void(0);" class="tweet-entry-time">'+this.relative_time(h[g].createdAt)+'</a><div style="display: inline-block;"><img src="'+b+'" class="tweet-entry-avatar" /><div style="display: inline-block;"><div class="tweet-entry-author"><a target="_blank" href="https://twitter.com/'+f+"/statuses/"+h[g].id+'">'+f+'</a></div><div style="color: #707070;font-size: 12px!important;">@'+h[g].user.name+'</div></div></div></div><div class="chatnox-clearfix"></div><div class="tweet-entry-content"><p>'+d+"</p></div></div>")}_ChatNox_Events.query("#chatnox-widget-social-content")[0].innerHTML=c.join("")},get_user_facebook_timeline:function(){var b=_ChatNox_Config.widget_prefs.socialPrefs;if(!b){return}var a=b.facebook_id;if(!a){return}_chatnox_debug_log("Req sending for fb graph.");_ChatNox_Requester.send_jsonp_request("/client/client-chat/social/facebook/token",{},function(c){var d={};d.access_token=c.response.token;_ChatNox_Requester.send_jsonp_request("https://graph.facebook.com/"+a,d,function(e){_chatnox_debug_log(e);if(e.error){_ChatNox_Events.query("#chatnox-widget-facebook-content")[0].innerHTML="<div style='font-size: 12px;margin-left: 10px;margin-top: 10px;'>"+e.error.message+"</div>";return}var g=15;if(_ChatNox_Util.get_user_config_theme()=="novel"){g=20}var f="https://www.facebook.com/"+a;var h='<iframe src="https://www.facebook.com/plugins/likebox.php?href='+decodeURIComponent(f)+"&amp;width=250px&amp;height=258&amp;colorscheme=light&amp;show_faces=true&amp;header=false&amp;stream=false&amp;show_border=false&connections="+g+'"  scrolling="no" frameborder="0" style="border:none; overflow:hidden; height:300px;" width="100%" allowTransparency="true"></iframe>';var h='<iframe src="https://www.facebook.com/plugins/fan.php?logobar=true&connections=20&height=250px&width=250px&id='+e.id+"&amp;width=250px&amp;height=258&amp;colorscheme=light&amp;show_faces=true&amp;header=false&amp;stream=false&amp;show_border=false&connections="+g+'"  scrolling="no" frameborder="0" style="border:none; overflow:hidden; height:300px;" width="100%" allowTransparency="true"></iframe>';_ChatNox_Events.query("#chatnox-widget-facebook-content")[0].innerHTML=h})})},add_fb_root_element:function(){if(_ChatNox_Util.get_user_config_theme()!="novel"){return}var a=document.getElementById("fb-root");if(!a){a=document.createElement("div");a.id="fb-root";document.body.appendChild(a)}(function(f,b,g){var e,c=f.getElementsByTagName(b)[0];if(f.getElementById(g)){return}e=f.createElement(b);e.id=g;e.src="//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3&appId=1022253017809015";c.parentNode.insertBefore(e,c)}(document,"script","facebook-jssdk"))}};var _ChatNox_Window_Chat_Sound={pref_name:"sound-alert",default_class:"chatnox-icons-sound",init_handler:function(){_ChatNox_Events.bind("#chatnox-widget-sound-option","click",function(){var b=_ChatNox_Events.query("#chatnox-widget-sound-option")[0];if(!b){return}var c=b.className;if(c==_ChatNox_Window_Chat_Sound.default_class+"-muted"){b.className=_ChatNox_Window_Chat_Sound.default_class+"-unmuted"}else{b.className=_ChatNox_Window_Chat_Sound.default_class+"-muted"}var a=(c==_ChatNox_Window_Chat_Sound.default_class+"-muted")?"unmuted":"muted";_ChatNox_Prefs.set_prefs(_ChatNox_Window_Chat_Sound.pref_name,a)})},get_state:function(){var a=_ChatNox_Prefs.get_prefs(this.pref_name);return(!a)?"unmuted":a}};var _ChatNox_Timeago_Blinker={timeago:function(){_chatnox_debug_log("timeago");var b=_ChatNox_Events.query(".chatnox-timeago");for(var a=0;a<b.length;a++){try{if(!b[a]){continue}var d=b[a].getAttribute("rel");if(!d){continue}b[a].innerText=this.get_formatted_time(d)}catch(c){}}setTimeout("_ChatNox_Timeago_Blinker.timeago()",30000)},get_formatted_time:function(e){var c;if(e){e=parseFloat(e);c=new Date(e)}var a=c.getHours();var d=c.getMinutes();var b=(a>=12)?"PM":"AM";a=(a>12)?(a%12):a;a+="";d+="";if(a.length==1){a="0"+a}if(d.length==1){d="0"+d}return a+":"+d+" "+b}};(function(){setTimeout("_ChatNox_Timeago_Blinker.timeago()",30000)})();var _ChatNox_typing_pings={typing_timer:"",send_typing_alert:function(a){var c=_ChatNox_session.get_session();if(!c||c.indexOf("ChatNox")!=-1){return}var b="";if(a=="typing"){b=_ChatNox_Events.query("#chatnox-chat-message")[0].value;b=(!b)?"":b.trim();if(!b){return}}var d={};d.session_id=c;d.ghost_message=b;_ChatNox_Requester.send_jsonp_request("/client/client-chat/typing/"+a,d,function(e){})},clear_timer:function(){if(this.typing_timer){clearInterval(this.typing_timer)}},start_timer:function(){_chatnox_debug_log("start_timer");this.clear_timer();this.typing_timer=setInterval(function(){_chatnox_debug_log("checking timer");_ChatNox_typing_pings.send_typing_alert("typing")},2000)},handle_typing_alert:function(c){_chatnox_debug_log("handle typing...");var b=c.action;if(!b){return}var a=c.session_id;return(b=="left")?this.remove_typing_alert():this.append_typing_alert()},remove_typing_alert:function(){_chatnox_debug_log("remove_typing_ui");_ChatNox_Misc.remove(".chatnox-typing-alert")},append_typing_alert:function(){_chatnox_debug_log("append_typing_ui");this.remove_typing_alert();_ChatNox_Window.add_to_window("typing-message",{})},focused:function(){_ChatNox_typing_pings.start_timer();_ChatNox_typing_pings.send_typing_alert("typing")}};function _chatnox_validate_form(a){_ChatNox_Window.reset_form(a);var b=_ChatNox_Events.query("#"+a+" input, #"+a+" textarea, #"+a+" select");for(var d=0;d<b.length;d++){var c=b[d];if(c.type=="button"||c.type=="submit"){continue}if(_chatnox_validate_field(c)){continue}var e=c.parentNode;e.className=(e.className)?(e.className.trim()+" chatnox-error-input"):"chatnox-error-input";c.focus();return false}return true}function _chatnox_validate_field(a){var d=false,b="text",c;d=(a.required||a.getAttribute("required"))?true:false;b=_ChatNox_Events.ele_type(a);c=a.value.trim();if(d||c){if(b){b=b.toLowerCase()}if(b=="email"||b=="phone"||b=="url"){return _ChatNox_Misc.is_valid_data_type_value(b,c)}else{if(d&&!c){return false}}}return true}var MessageDigest=function(t){function M(b,a){return(b<<a)|(b>>>(32-a))}function L(k,b){var F,a,d,x,c;d=(k&2147483648);x=(b&2147483648);F=(k&1073741824);a=(b&1073741824);c=(k&1073741823)+(b&1073741823);if(F&a){return(c^2147483648^d^x)}if(F|a){if(c&1073741824){return(c^3221225472^d^x)}else{return(c^1073741824^d^x)}}else{return(c^d^x)}}function s(a,c,b){return(a&c)|((~a)&b)}function r(a,c,b){return(a&b)|(c&(~b))}function q(a,c,b){return(a^c^b)}function o(a,c,b){return(c^(a|(~b)))}function v(G,F,ab,aa,k,H,I){G=L(G,L(L(s(F,ab,aa),k),I));return L(M(G,H),F)}function f(G,F,ab,aa,k,H,I){G=L(G,L(L(r(F,ab,aa),k),I));return L(M(G,H),F)}function E(G,F,ab,aa,k,H,I){G=L(G,L(L(q(F,ab,aa),k),I));return L(M(G,H),F)}function u(G,F,ab,aa,k,H,I){G=L(G,L(L(o(F,ab,aa),k),I));return L(M(G,H),F)}function e(k){var G;var d=k.length;var c=d+8;var b=(c-(c%64))/64;var F=(b+1)*16;var H=Array(F-1);var a=0;var x=0;while(x<d){G=(x-(x%4))/4;a=(x%4)*8;H[G]=(H[G]|(k.charCodeAt(x)<<a));x++}G=(x-(x%4))/4;a=(x%4)*8;H[G]=H[G]|(128<<a);H[F-2]=d<<3;H[F-1]=d>>>29;return H}function C(c){var b="",d="",k,a;for(a=0;a<=3;a++){k=(c>>>(a*8))&255;d="0"+k.toString(16);b=b+d.substr(d.length-2,2)}return b}function K(b){b=b.replace(/\r\n/g,"\n");var a="";for(var k=0;k<b.length;k++){var d=b.charCodeAt(k);if(d<128){a+=String.fromCharCode(d)}else{if((d>127)&&(d<2048)){a+=String.fromCharCode((d>>6)|192);a+=String.fromCharCode((d&63)|128)}else{a+=String.fromCharCode((d>>12)|224);a+=String.fromCharCode(((d>>6)&63)|128);a+=String.fromCharCode((d&63)|128)}}}return a}var D=Array();var Q,h,J,w,g,Z,Y,X,W;var T=7,R=12,O=17,N=22;var B=5,A=9,z=14,y=20;var p=4,n=11,m=16,l=23;var V=6,U=10,S=15,P=21;t=K(t);D=e(t);Z=1732584193;Y=4023233417;X=2562383102;W=271733878;for(Q=0;Q<D.length;Q+=16){h=Z;J=Y;w=X;g=W;Z=v(Z,Y,X,W,D[Q+0],T,3614090360);W=v(W,Z,Y,X,D[Q+1],R,3905402710);X=v(X,W,Z,Y,D[Q+2],O,606105819);Y=v(Y,X,W,Z,D[Q+3],N,3250441966);Z=v(Z,Y,X,W,D[Q+4],T,4118548399);W=v(W,Z,Y,X,D[Q+5],R,1200080426);X=v(X,W,Z,Y,D[Q+6],O,2821735955);Y=v(Y,X,W,Z,D[Q+7],N,4249261313);Z=v(Z,Y,X,W,D[Q+8],T,1770035416);W=v(W,Z,Y,X,D[Q+9],R,2336552879);X=v(X,W,Z,Y,D[Q+10],O,4294925233);Y=v(Y,X,W,Z,D[Q+11],N,2304563134);Z=v(Z,Y,X,W,D[Q+12],T,1804603682);W=v(W,Z,Y,X,D[Q+13],R,4254626195);X=v(X,W,Z,Y,D[Q+14],O,2792965006);Y=v(Y,X,W,Z,D[Q+15],N,1236535329);Z=f(Z,Y,X,W,D[Q+1],B,4129170786);W=f(W,Z,Y,X,D[Q+6],A,3225465664);X=f(X,W,Z,Y,D[Q+11],z,643717713);Y=f(Y,X,W,Z,D[Q+0],y,3921069994);Z=f(Z,Y,X,W,D[Q+5],B,3593408605);W=f(W,Z,Y,X,D[Q+10],A,38016083);X=f(X,W,Z,Y,D[Q+15],z,3634488961);Y=f(Y,X,W,Z,D[Q+4],y,3889429448);Z=f(Z,Y,X,W,D[Q+9],B,568446438);W=f(W,Z,Y,X,D[Q+14],A,3275163606);X=f(X,W,Z,Y,D[Q+3],z,4107603335);Y=f(Y,X,W,Z,D[Q+8],y,1163531501);Z=f(Z,Y,X,W,D[Q+13],B,2850285829);W=f(W,Z,Y,X,D[Q+2],A,4243563512);X=f(X,W,Z,Y,D[Q+7],z,1735328473);Y=f(Y,X,W,Z,D[Q+12],y,2368359562);Z=E(Z,Y,X,W,D[Q+5],p,4294588738);W=E(W,Z,Y,X,D[Q+8],n,2272392833);X=E(X,W,Z,Y,D[Q+11],m,1839030562);Y=E(Y,X,W,Z,D[Q+14],l,4259657740);Z=E(Z,Y,X,W,D[Q+1],p,2763975236);W=E(W,Z,Y,X,D[Q+4],n,1272893353);X=E(X,W,Z,Y,D[Q+7],m,4139469664);Y=E(Y,X,W,Z,D[Q+10],l,3200236656);Z=E(Z,Y,X,W,D[Q+13],p,681279174);W=E(W,Z,Y,X,D[Q+0],n,3936430074);X=E(X,W,Z,Y,D[Q+3],m,3572445317);Y=E(Y,X,W,Z,D[Q+6],l,76029189);Z=E(Z,Y,X,W,D[Q+9],p,3654602809);W=E(W,Z,Y,X,D[Q+12],n,3873151461);X=E(X,W,Z,Y,D[Q+15],m,530742520);Y=E(Y,X,W,Z,D[Q+2],l,3299628645);Z=u(Z,Y,X,W,D[Q+0],V,4096336452);W=u(W,Z,Y,X,D[Q+7],U,1126891415);X=u(X,W,Z,Y,D[Q+14],S,2878612391);Y=u(Y,X,W,Z,D[Q+5],P,4237533241);Z=u(Z,Y,X,W,D[Q+12],V,1700485571);W=u(W,Z,Y,X,D[Q+3],U,2399980690);X=u(X,W,Z,Y,D[Q+10],S,4293915773);Y=u(Y,X,W,Z,D[Q+1],P,2240044497);Z=u(Z,Y,X,W,D[Q+8],V,1873313359);W=u(W,Z,Y,X,D[Q+15],U,4264355552);X=u(X,W,Z,Y,D[Q+6],S,2734768916);Y=u(Y,X,W,Z,D[Q+13],P,1309151649);Z=u(Z,Y,X,W,D[Q+4],V,4149444226);W=u(W,Z,Y,X,D[Q+11],U,3174756917);X=u(X,W,Z,Y,D[Q+2],S,718787259);Y=u(Y,X,W,Z,D[Q+9],P,3951481745);Z=L(Z,h);Y=L(Y,J);X=L(X,w);W=L(W,g)}var j=C(Z)+C(Y)+C(X)+C(W);return j.toLowerCase()};var BrowserDetect={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.OS=this.searchString(this.dataOS)||"unknown"},searchString:function(e){for(var b=0;b<e.length;b++){var c=e[b].string;var d=e[b].prop;var a=e[b].match;this.versionSearchString=e[b].versionSearch||e[b].identity;if(a&&c.match(a)){return e[b].identity}if(c){if(c.indexOf(e[b].subString)!=-1){return e[b].identity}}else{if(d){return e[b].identity}}}},searchVersion:function(b){var a=b.indexOf(this.versionSearchString);if(a==-1){return}return parseFloat(b.substring(a+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,match:/Trident.*rv[ :]*11\./,identity:"Explorer"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"},{string:navigator.userAgent,match:/Android\s([0-9\.]*)/,subString:"Android",identity:"Android"}]};BrowserDetect.init();function chatnox_add_animation_effect(a){var c=chatnox_is_animation_effect_exists();if(!c||c=="none"){return}var b=document.getElementById(a);b.removeAttribute("class");b.className="chatnox-animated "+c}function chatnox_check_and_load_animation_css(){if(!chatnox_is_animation_effect_exists()){return}_ChatNox_Util.load_css_file(_ChatNox_Config.app_url+"/css/chatnox-animate.css")}function chatnox_is_animation_effect_exists(){var a=_ChatNox_Config.widget_prefs;var b=(a.group_status=="online")?a.chatBarPrefs.online_chat_bar_animaton:a.chatBarPrefs.offline_chat_bar_animaton;if(!b||b=="none"){return false}return b}var _ChatNox_Events={bind:function(a,c,d){try{try{if(!jQuery){throw error("No Jquery")}jQuery(a).unbind().bind(c,function(f){if(d){d(f)}})}catch(b){if(typeof(window.MooTools)=="object"){$$(a).addEvent(c,function(f){if(d){d(f)}})}else{snack.wrap(a).attach(c,function(f){if(d){d(f)}})}}}catch(b){}},query:function(a){try{if(!jQuery){throw error("No Jquery")}return jQuery(a)}catch(b){if(typeof(window.MooTools)=="object"){return $$(a)}else{return snack.wrap(a)}}},ele_type:function(a){return(!a)?"text":((a.type=="textarea")?"textarea":(a.getAttribute("type")?a.getAttribute("type"):(a.type?a.type:type)))},init_window_events:function(){this.bind("#chatnox-offline-submit","click",function(e){var g=_ChatNox_Events.query("#chatnox-offline-submit")[0];if(g.getAttribute("disabled")){return false}var a="chatnox-widget-offline-form";var d=_chatnox_validate_form(a);if(!d){return false}var h={};h.dept_id=_ChatNox_Misc.get_selected_group_id("online");h.message=_ChatNox_Events.query("#chatnox-offline-message")[0].value;var b=_ChatNox_Misc.visitor_info();var f=_chatnox_serialize_form(a);b.form_fields=f;h.visitor_info=JSON.stringify(b);_ChatNox_Prefs.set_prefs(_ChatNox_session.visitor_prefs,JSON.stringify(f));g.setAttribute("disabled",true);var c=g;_ChatNox_Js_Api.on_event_fired("OFFLNE_CHAT_INITIATED",h.message);_ChatNox_Requester.send_jsonp_request("/client/client-chat/offline/"+_ChatNox_Misc.get_selected_group_id("offline"),h,function(j){_chatnox_debug_log(j);_ChatNox_Chat_Ui.show_offline_success();c.removeAttribute("disabled");_ChatNox_GA.push_event("offline_message","-")})});this.bind("#chatnox-close","click",function(a){_chatnox_debug_log("close");_ChatNox_session.ask_confirmation_and_close()});this.bind("#chatnox-widget-twitter-option","click",function(a){_ChatNox_Chat_Ui.show_twitter();_ChatNox_GA.push_event("twitter","-")});this.bind("#chatnox-widget-facebook-option","click",function(a){_ChatNox_Chat_Ui.show_facebook();_ChatNox_GA.push_event("facebook","-")});this.bind("#chatnox-widget-bar","click",function(a){_ChatNox_Chat.show_window();_ChatNox_GA.push_event("bubble_clicked","-");_ChatNox_Visitor_Activity.setStatusToClickedChatBar()});this.bind("#chatnox-minimize","click",function(a){_ChatNox_Chat.minimize_window()});this.bind("#chatnox-online-submit","click",function(c){var a="chatnox-widget-online-form";var b=_chatnox_validate_form(a);if(!b){return false}_chatnox_debug_log("proceed");document.getElementById("chatnox-chats-container").innerHTML="";var e=_ChatNox_Events.query("#chatnox-online-message")[0].value;_ChatNox_Chat_Ui.show_chat_session();var d=_chatnox_serialize_form("chatnox-widget-online-form");if(d){_ChatNox_Prefs.set_prefs(_ChatNox_session.visitor_prefs,JSON.stringify(d))}_ChatNox_Window.append_message(e,"VISITOR");_ChatNox_session.send_message(e,"VISITOR_INITIATED");_ChatNox_Js_Api.on_event_fired("ONLINE_CHAT_INITIATED",e)});document.getElementById("chatnox-online-message").onkeydown=function(a){a=a||event;if(!(a.keyCode===13&&!a.ctrlKey)){return true}_ChatNox_Events.stop_propogation(a);_ChatNox_Events.query("#chatnox-online-message")[0].blur();_ChatNox_Events.query("#chatnox-online-submit")[0].click()};document.getElementById("chatnox-chat-message").onkeydown=function(a){a=a||event;if(!(a.keyCode===13&&!a.ctrlKey)){return true}_ChatNox_Events.stop_propogation(a);setTimeout(function(){var b=_ChatNox_Events.query("#chatnox-chat-message")[0].value;b=b.trim();if(b){_ChatNox_Window.append_message(b,"VISITOR");_ChatNox_session.send_message(b)}return false},0);return false};this.bind("#chatnox-chat-message","blur",function(a){_ChatNox_typing_pings.clear_timer();_ChatNox_typing_pings.send_typing_alert("left")});_ChatNox_Window_Chat_Sound.init_handler();_ChatNox_Window_Chat_Rating.init_handlers();_ChatNox_Window_Chat_Rating.rate_chat(_ChatNox_Window_Chat_Rating.get_chat_rating(),"init")},stop_propogation:function(b){b=b||event;try{if(b.stopPropagation){b.stopPropagation()}else{b.cancelBubble=true}}catch(a){}}};var _ChatNox_Misc={relative_time:function(f){var b=60*1000;var g=b*60;var e=g*24;var d=e*30;var c=e*365;var a=new Date().getTime()-new Date(f).getTime();if(a<b){return Math.round(a/1000)+" seconds ago"}else{if(a<g){return Math.round(a/b)+" minute(s) ago"}else{if(a<e){return Math.round(a/g)+" hour(s) ago"}else{if(a<d){return"approximately "+Math.round(a/e)+" days ago"}else{if(a<c){return"approximately "+Math.round(a/d)+" months ago"}else{return"approximately "+Math.round(a/c)+" years ago"}}}}}},format_bytes:function(b,a){if(b==0){return"0 Byte"}var d=1000;var c=a+1||3;var f=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"];var e=Math.floor(Math.log(b)/Math.log(d));return(b/Math.pow(d,e)).toPrecision(c)+" "+f[e]},visitor_info:function(){var b={};b.from_url=encodeURIComponent(document.location.href);b.referrer=encodeURIComponent(document.referrer);b.os=BrowserDetect.OS;b.browser=BrowserDetect.browser;b.version=BrowserDetect.version;try{if(BrowserDetect.browser&&BrowserDetect.browser.indexOf("fox")!=-1){b.client_date=new Date().toLocaleFormat()}else{b.client_date=new Date()+""}}catch(a){}return b},is_valid_data_type_value:function(g,f){var c=false;if(g){g=g.toLowerCase()}switch(g){case"email":var e=new RegExp(/^(("[\w-\s]+")|([\w-]+(?:\.[\w-]+)*)|("[\w-\s]+")([\w-]+(?:\.[\w-]+)*))(@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$)|(@\[?((25[0-5]\.|2[0-4][0-9]\.|1[0-9]{2}\.|[0-9]{1,2}\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\]?$)/i);f=f.replace(/^\s*/,"").replace(/\s*$/,"");c=(!e.test(f))?false:true;break;case"phone":var b=/^((\+)?[1-9]{1,2})?([-\s\.])?((\(\d{1,4}\))|\d{1,4})(([-\s\.])?[0-9]{1,12}){1,2}$/;var a=f.split("").length;var c=b.test(f);break;case"url":var d=/^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!10(?:\.\d{1,3}){3})(?!127(?:\.\d{1,3}){3})(?!169\.254(?:\.\d{1,3}){2})(?!192\.168(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/i;c=d.test(f);break;default:break}return c},get_visitor_prefs:function(d,a){var b=_ChatNox_Prefs.get_prefs(_ChatNox_session.visitor_prefs);if(!b){return""}b=JSON.parse(b);if(d=="custom"&&a){for(var c=0;c<b.length;c++){if(b[c].name==a){return b[c].value}}}else{for(var c=0;c<b.length;c++){if(d=="custom"&&b[c].field_type==d){return b[c].value}else{if(b[c].type==d){return b[c].value}}}}return""},prefill_form_fields_with_history:function(a){var b=_ChatNox_Events.query("#"+a+" input");for(var f=0;f<b.length;f++){try{var d=b[f];if(d.type=="button"||d.type=="submit"){continue}var g=_ChatNox_Events.ele_type(d);if(d.getAttribute("id").indexOf("custom")!=-1){g="custom"}d.value=this.get_visitor_prefs(g,(g=="custom"?d.getAttribute("placeholder"):undefined))}catch(h){}}if(_ChatNox_Config.widget_prefs.groupList.length<=1){return}var c=_ChatNox_Events.query("#"+a+" select");for(var f=0;f<c.length;f++){try{}catch(h){}}},remove:function(c){var b=_ChatNox_Events.query(c);if(!b||b.length==0){return}for(var a=0;a<b.length;a++){try{b[a].parentNode.removeChild(b[a])}catch(d){}}},play_sound:function(a){try{var b=_ChatNox_Window_Chat_Sound.get_state();if(b=="muted"){return}var d="";if(a){d=_ChatNox_Config.widget_prefs.notificationSounds[a]}if(!d){d=_ChatNox_Config.sound_path}new Audio(d).play()}catch(c){}},parse_anchor_tags:function(c){var b=/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig;try{return c.replace(b,"<a href='$1' target='_blank' class='cd_hyperlink'>$1</a>")}catch(a){return c}},get_selected_group_id:function(a){if(!a){return _ChatNox_Client_APP.get_account()}var c=_ChatNox_Events.query("#chatnox-widget-"+a+"-form select");for(var b=0;b<c.length;b++){try{if(c[b].value){return c[b].value}}catch(d){}}return _ChatNox_Client_APP.get_account()}};var _ChatNox_render_template={render:function(){var b=_ChatNox_Config.widget_prefs;document.body.appendChild(_ChatNox_Templates.get_template("theme-container",b));document.body.appendChild(_ChatNox_Templates.get_template("chat-button",b));var a=document.getElementById("chatnox-widget");a.appendChild(_ChatNox_Templates.get_template("bar",b));var a=document.getElementById("chatnox-widget-container");a.appendChild(_ChatNox_Templates.get_template("header",b));try{a.appendChild(_ChatNox_Templates.get_template("header-image",b));a.appendChild(_ChatNox_Templates.get_template("chat-social-container",b));a.appendChild(_ChatNox_Templates.get_template("chat-facebook-container",b))}catch(c){}a.appendChild(_ChatNox_Templates.get_template("online-form",b));a.appendChild(_ChatNox_Templates.get_template("offline-form",b));a.appendChild(_ChatNox_Templates.get_template("offline-success-holder",b));a.appendChild(_ChatNox_Templates.get_template("chat-messages-container",b))}};var _ChatNox_Chat={back_to_chat:function(){var a=_ChatNox_session.get_session();if(!a){_ChatNox_Chat_Ui.open_window_on_status();return}_ChatNox_Chat_Ui.show_chat_session()},show_window:function(){_ChatNox_Prefs.set_prefs(_ChatNox_Chat_Ui.chat_bar_opened_cookie,"opened");_ChatNox_Trigger_Message.clear_timer();var a=_ChatNox_Events.query("#chatnox-widget")[0].className;if(a&&a.indexOf("chatnox-minimized")>-1){_ChatNox_Events.query("#chatnox-widget")[0].className=this.replace_string(a,"chatnox-minimized");_ChatNox_Chat_Ui.toggle_parent_containers()}else{_ChatNox_session.check_session()}},remove_grabber:function(a){this.cancel_bubbling(a);_ChatNox_Prefs.create_cookie(_ChatNox_Chat_Ui.chat_grabber_closed,"closed");_ChatNox_Chat_Ui.apply_css("chatnox-profile-line",{display:"none"})},replace_string:function(b,a){return b.replace(a,"").trim()},minimize_window:function(){var a=_ChatNox_Events.query("#chatnox-widget")[0];a.className=this.replace_string(a.className,"chatnox-minimized")+" chatnox-minimized";_ChatNox_Prefs.delete_prefs(_ChatNox_Chat_Ui.chat_bar_opened_cookie);_ChatNox_Chat_Ui.toggle_parent_containers("window")},cancel_bubbling:function(b){try{if(b.stopPropagation){b.stopPropagation()}else{b.cancelBubble=true}}catch(a){}}};var _ChatNox_Chat_Ui={chat_bar_opened_cookie:"chat_bar_opened",chat_grabber_closed:"chat_grabber_closed",bar_window_ids:["chatnox-widget-bar","chatnox-widget-container"],form_ids:["chatnox-widget-chat-wrap","chatnox-widget-online-form","chatnox-widget-chat-social-wrap","chatnox-widget-chat-facebook-wrap","chatnox-widget-offline-form","chatnox-widget-offline-success"],load_template:function(b,a){_ChatNox_Util.load_js(_ChatNox_Config.app_url+"/site/theme-templates/min/"+_ChatNox_Util.get_user_config_theme()+".js",function(){if(b){_ChatNox_render_template.render()}if(a){a()}})},load_mobile_template:function(){var c=_ChatNox_Config.widget_prefs;var e=(c.group_status=="online")?c.mobileOptimizePrefs.online_text:c.mobileOptimizePrefs.offline_text;var b=_ChatNox_Config.app_url;b=b.replace("https://chatnoxapp.appspot.com","https://app.chatnox.com");var d="right: 10px; left: auto;";if(c.chatBarPrefs.chat_window_position=="left"){d="left: 10px; right: auto;"}var a=document.createElement("a");a.href=b+"/mobile-widget?id="+_ChatNox_Client_APP.get_account();a.target="_blank";a.style.textDecoration="none";a.style.zIndex="20000000000000000";a.innerHTML='<div class="chatNox-mobile-button" style="z-index:20000000000000000;background-color: '+c.themePrefs.widget_theme_color_code+"!important;"+d+';"><span> '+e+"</span></div>";document.body.appendChild(a)},show_bar:function(){if(_ChatNox_Client_APP.is_window_in_popup()){this.open_window_on_status();return}if(_ChatNox_Util.is_mobile_browser()&&_ChatNox_Client_APP.is_mobile_optimized()){return}this.show_window("chatnox-widget-bar","bar");chatnox_add_animation_effect("chatnox-widget-bar")},check_all_online_form_fields_switched_off:function(){var a=false;var b=_ChatNox_Config.widget_prefs.onlinePrefs;if(b&&!b.show_name_field&&!b.show_email_field&&(!_ChatNox_Config.widget_prefs.groupList||_ChatNox_Config.widget_prefs.groupList.length<1)){a=true;if(b.show_custom_field_user&&!b.show_custom_field){a=true}else{if(b.show_custom_field_user&&b.show_custom_field){a=false}}}return a},show_online:function(){if(this.check_all_online_form_fields_switched_off()){this.show_chat_session();document.getElementById("chatnox-chats-container").innerHTML="";_ChatNox_Window.append_message(_ChatNox_Config.widget_prefs.onlinePrefs.info_message);return}this.show_window("chatnox-widget-online-form")},show_offline:function(){this.show_window("chatnox-widget-offline-form")},show_offline_success:function(){try{this.show_window("chatnox-widget-offline-success")}catch(b){_chatnox_debug_log(b)}var a=document.getElementById("chatnox-widget-offline-success");a.innerHTML="";a.appendChild(_ChatNox_Templates.get_template("offline-success",{}))},show_chat_session:function(){this.show_window("chatnox-widget-chat-wrap")},show_twitter:function(){this.show_window("chatnox-widget-chat-social-wrap");try{document.getElementById("chatnox-widget-social-content").innerHTML="<div style='font-size: 12px;margin-left: 10px;margin-top: 10px;'>Fetching latest tweets...</div>"}catch(a){}_ChatNox_Social.get_user_tweets()},show_facebook:function(){this.show_window("chatnox-widget-chat-facebook-wrap");try{document.getElementById("chatnox-widget-facebook-content").innerHTML="<div style='font-size: 12px;margin-left: 10px;margin-top: 10px;'>Loading...</div>"}catch(a){}_ChatNox_Social.get_user_facebook_timeline()},show_window:function(g,c){var b="block";if(_ChatNox_Util.is_mobile_browser()&&_ChatNox_Client_APP.is_mobile_optimized()){b="table-row"}var d=this.form_ids;for(var a=0;a<d.length;a++){this.apply_css(d[a],{display:(d[a]==g)?b:"none"})}this.toggle_parent_containers(c);if(!c){this.window_title(g);_ChatNox_Window.reset_form(g,"clear");try{_ChatNox_Misc.prefill_form_fields_with_history(g)}catch(f){_chatnox_debug_log(f)}}},show_live_chat_button:function(a){if(_ChatNox_Client_APP.is_window_in_popup()){return}if(_ChatNox_Util.is_mobile_browser()&&!_ChatNox_Client_APP.is_mobile_optimized()){return}return;_ChatNox_Chat_Ui.apply_css("chatnox-live-chat-button-container",{display:(a)?"block":"none"})},toggle_parent_containers:function(b){var a="block";if(_ChatNox_Util.is_mobile_browser()&&_ChatNox_Client_APP.is_mobile_optimized()){a="table-row"}this.apply_css("chatnox-widget-bar",{display:(b)?a:"none"});this.apply_css("chatnox-widget-container",{display:(!b)?a:"none"})},apply_css:function(a,b){try{var c=document.getElementById(a);for(key in b){c.style[key]=b[key]}}catch(d){_chatnox_debug_log(d)}},window_title:function(d){var c="Live Chat";switch(d){case"chatnox-widget-chat-wrap":if(_ChatNox_session.agent_json&&_ChatNox_Util.get_user_config_theme()!="novel"){c=_ChatNox_session.agent_json.name}else{c=_ChatNox_Config.widget_prefs.onlinePrefs.chat_window_text}break;case"chatnox-widget-online-form":c=_ChatNox_Config.widget_prefs.onlinePrefs.chat_window_text;break;case"chatnox-widget-offline-form":c=_ChatNox_Config.widget_prefs.offlinePrefs.chat_window_text;break;case"chatnox-widget-chat-facebook-wrap":c=_ChatNox_Config.widget_prefs.socialPrefs.facebook_id;break;default:if(_ChatNox_session.agent_json&&_ChatNox_Util.get_user_config_theme()!="novel"){c=_ChatNox_session.agent_json.name}else{c=_ChatNox_Config.widget_prefs.onlinePrefs.chat_window_text}break}document.getElementById("chatnox-window-title").innerHTML=c;var b={};try{b.image=(_ChatNox_session.agent_json)?_ChatNox_session.agent_json.image_url:(_ChatNox_Config.widget_prefs.themePrefs.theme_company_logo?_ChatNox_Config.widget_prefs.themePrefs.theme_company_logo:_ChatNox_Config.window_image)}catch(a){}try{b.name=(_ChatNox_session.agent_json)?_ChatNox_session.agent_json.name:Chanox_Default_Globals.name;b.role=(_ChatNox_session.agent_json)?_ChatNox_session.agent_json.designation:Chanox_Default_Globals.designation}catch(a){}this.show_agent_info(b)},show_agent_info:function(b){try{if(b.image){document.getElementById("chatnox-company-image").src=b.image}}catch(a){}try{if(b.name){document.getElementById("chatnox-operator-name").innerHTML=b.name}}catch(a){}try{if(b.role){document.getElementById("chatnox-operator-role").innerHTML=b.role}}catch(a){}},open_window_on_status:function(){var a=_ChatNox_Config.widget_prefs.group_status;if(a=="online"){_ChatNox_Chat_Ui.show_online()}else{_ChatNox_Chat_Ui.show_offline()}_ChatNox_Social.add_fb_root_element()},fire_click:function(a){try{if(!a){return}var b=_ChatNox_Events.query(a)[0];if(b.onclick){b.onclick()}else{if(b.click){b.click()}}}catch(c){}},remove_class:function(a,c){var d=_ChatNox_Events.query(a);for(var b=0;b<d.length;b++){this.remove_class_to_element(d[b],c)}},remove_class_to_element:function(c,d){try{var b=d.split(" ");for(var a=0;a<b.length;a++){var h=c.className;var f=new RegExp("/"+b[a]+"/g");h=h.replace(b[a],"");c.className=h.trim()}}catch(g){_chatnox_debug_log(g)}},add_class:function(a,c){var d=_ChatNox_Events.query(a);for(var b=0;b<d.length;b++){this.add_class_to_element(d[b],c)}},add_class_to_element:function(a,b){try{this.remove_class_to_element(a,b);a.className+=" "+b}catch(c){}}};var _ChatNox_Window={append_message:function(c,b,d){d=(!d)?new Date().getTime():d;var a={};a.message=c;a.from=b;a.time=d;if(b=="no-escape"){a.no_escape=true}var e="append-chat-message";if(c.indexOf("[")==0){e="system-message"}this.add_to_window(e,a)},add_to_window:function(b,a){_ChatNox_Misc.remove(".chatnox-typing-alert");_ChatNox_Events.query("#chatnox-chats-container")[0].appendChild(_ChatNox_Templates.get_template(b,a));if(b=="typing-message"){return}this.scroll_to_bottom()},scroll_to_bottom:function(){var a=_ChatNox_Events.query("#chatnox-widget-content")[0];a.scrollTop=a.scrollHeight},reset_chat_box:function(){_ChatNox_Events.query("#chatnox-chat-message")[0].value=""},refresh_window:function(a){if(!a){return}for(var b=0;b<a.length;b++){var c=a[b];if(c.hidden_to_visitor){continue}this.append_message(c.message,c.from,c.time*1000)}},reset_form:function(b,a){var c=_ChatNox_Events.query("#"+b+" input, #"+b+" textarea, #"+b+" select");for(var e=0;e<c.length;e++){var d=c[e];var g=d.parentNode;if(!g){continue}var f=g.className;f=(!f)?"":f;g.className=f.replace("chatnox-error-input","");if(a){d.value=""}}}};var Chanox_Default_Globals={name:"Operator",designation:"Customer Support",reset_with_config_values:function(){var a=_ChatNox_Config.widget_prefs.themePrefs;if(a.operator_role){this.designation=a.operator_role}if(a.operator_text){this.name=a.operator_text}},};var _ChatNox_Group_Util={is_valid_to_show:function(){var c=_ChatNox_Config.widget_prefs;if(!c.conditional_page_rules){return true}var d=c.conditional_page_rules;var b=this.is_valid_show_rules(d);var a=this.is_valid_hide_rules(d);_chatnox_debug_log(b+" : "+a);if(b&&!a){return true}return false},is_valid_show_rules:function(b){if(b.show_in_pages=="all"){return true}var a=b.page_urls_to_show;if(this.check_conditional_rules(a)){return true}return false},is_valid_hide_rules:function(b){if(b.hide_in_pages=="none"){return false}var a=b.page_urls_to_hide;_chatnox_debug_log(a);if(this.check_conditional_rules(a)){return true}return false},check_conditional_rules:function(f){if(!f||f.length==0){return true}for(var c=0;c<f.length;c++){var a=f[c];try{a=JSON.parse(a)}catch(d){}var b=document.location.href.split("?")[0];if(chatnox_is_valid_condition(a.CONDITION,b,a.RHS)){return true}}return false}};var _ChatNox_Util={load_css_file:function(a){var b=document.createElement("link");b.setAttribute("type","text/css");b.setAttribute("rel","stylesheet");b.setAttribute("href",a);if(!b){return}document.getElementsByTagName("head")[0].appendChild(b)},add_inline_css:function(b){try{b=b.replace(/\<br\\?>/g,"\n")}catch(f){}var a=document.createElement("style");a.innerHTML=b;document.body.appendChild(a);var d=document,a=d.createElement("style");d.getElementsByTagName("head")[0].appendChild(a);a.setAttribute("type","text/css");try{a.innerHTML=b}catch(g){a.styleSheet.cssText=acssString}},load_js:function(d,c){var a=document.createElement("script");a.type="text/javascript";a.async=true;a.src=d;if((navigator.appVersion).indexOf("MSIE")>0){a.onreadystatechange=function(){if((!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){if(c!=undefined){c()}}}}else{a.onload=function(){if((!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){if(c!=undefined){c()}}}}var b=document.getElementsByTagName("head")[0];b.appendChild(a)},unescape:function(a){if(typeof a=="string"){return _ChatNox_Util.unescape(a)}for(key in a){if(typeof a[key]=="object"){_ChatNox_Util.unescape(a[key])}else{try{a[key]=_ChatNox_Util.replace(a[key])}catch(b){}}}return a},replace:function(a){a.replace(/&#39;/g,"'").replace(/&#37;/g,"%").replace(/&#34;/g,'"').replace(/\r\n/g,"<br>").replace(/\\r\\n/g,"<br>").replace(/\r/g,"<br>").replace(/\r/g,"<br>")},parse_string:function(a){if(typeof a=="object"){return a}return this.decode_json(JSON.parse(a))},is_mobile_browser:function(){return(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent))},decode_json:function(a){if(!a){return}for(key in a){if(typeof a[key]=="object"){_ChatNox_Util.decode_json(a[key])}else{try{a[key]=a[key].replace(/&#39;/g,"'").replace(/&#37;/g,"%").replace(/&#34;/g,'"').replace(/\r\n/g,"<br>").replace(/\\r\\n/g,"<br>").replace(/\r/g,"<br>").replace(/\r/g,"<br>")}catch(b){}}}return a},get_user_config_theme:function(){var a=_ChatNox_Config.widget_prefs;if(a&&a.themePrefs.theme_name){return a.themePrefs.theme_name}else{return"metro"}}};var _ChatNox_Client_APP={get_account:function(){if(!_chatnox.setAccount){throw"Invalid Id"}return _chatnox.setAccount},start:function(){_ChatNox_Requester.send_jsonp_request("/client/website/prefs/"+this.get_account(),{},function(b){if(b.status!="success"){return}_ChatNox_Config.widget_prefs=_ChatNox_Util.parse_string(b.response);Chanox_Default_Globals.reset_with_config_values();if(_ChatNox_Util.is_mobile_browser()&&!_ChatNox_Client_APP.is_allow_to_show_on_mobile()){_ChatNox_Client_APP.create_visitor();return}if(_ChatNox_Util.is_mobile_browser()&&!_ChatNox_Client_APP.is_window_in_popup()&&_ChatNox_Client_APP.is_mobile_optimized()){if(!_ChatNox_Group_Util.is_valid_to_show()){_ChatNox_Client_APP.create_visitor();return}if(!_ChatNox_Client_APP.is_allow_to_show_on_mobile_on_status()){_ChatNox_Client_APP.create_visitor();return}_ChatNox_Util.load_css_file(_ChatNox_Config.app_url+"/site/css/mobile-style.css");_ChatNox_Chat_Ui.load_mobile_template();_ChatNox_Client_APP.subscribe();return}if(!_ChatNox_Group_Util.is_valid_to_show()){if(!_ChatNox_Util.is_mobile_browser()){_ChatNox_Chat_Ui.load_template(false,function(){_ChatNox_Web_Promotions.start();_ChatNox_Web_Stickybars.start()})}return}var a=_ChatNox_Config.widget_prefs.custom_css_prefs;if(a&&a.enabled&&a.css){_ChatNox_Util.add_inline_css(a.css)}else{_ChatNox_Util.load_css_file(_ChatNox_Config.app_url+"/site/css/"+_ChatNox_Util.get_user_config_theme()+".css")}chatnox_check_and_load_animation_css();_ChatNox_Chat_Ui.load_template(true,function(){_ChatNox_Events.init_window_events();_ChatNox_session.check_session("init");_ChatNox_Js_Api.call_api();if(!_ChatNox_Util.is_mobile_browser()){_ChatNox_Web_Promotions.start();_ChatNox_Web_Stickybars.start()}});_ChatNox_Client_APP.subscribe();_ChatNox_Visitor_Activity.startIdleTimer()})},subscribe:function(){if(_ChatNox_Config.widget_prefs.user_plan=="free"||this.is_window_in_popup()){return}ChatNox_Pusher_Obj_Visitor.subscribe()},is_window_in_popup:function(){return(typeof _chatNox_Window_In_Popout!="undefined")},is_mobile_optimized:function(){var a=_ChatNox_Config.widget_prefs;if(!a||!a.mobileOptimizePrefs||!a.mobileOptimizePrefs.optimzed){return false}return true},is_allow_to_show_on_mobile:function(){var a=_ChatNox_Config.widget_prefs;if(!a||!a.mobileOptimizePrefs){return false}if(a.mobileOptimizePrefs.show_on_mobile===undefined){return true}return(a.mobileOptimizePrefs.show_on_mobile)},is_allow_to_show_on_mobile_on_status:function(){var b=_ChatNox_Config.widget_prefs;if(!b||!b.mobileOptimizePrefs){return false}var a=_ChatNox_Config.widget_prefs.group_status;if(b.mobileOptimizePrefs.show_on_mobile===undefined){return true}if(b.mobileOptimizePrefs.show_when_online===undefined||b.mobileOptimizePrefs.show_when_offline===undefined){return true}if(a=="online"){return(b.mobileOptimizePrefs.show_when_online)}else{return(b.mobileOptimizePrefs.show_when_offline)}},create_visitor:function(){var a=_ChatNox_Config.widget_prefs.parent_key;if(a===5341593334972416){return}var b=ChatNox_Pusher_Obj_Visitor.info();b.user_key=a;_ChatNox_Requester.send_jsonp_request(_ChatNox_Config.app_url+"/client/pusher/add-visitor",b,function(c){})}};(function(){if(typeof _ChatNox_Available!=="undefined"){return}_ChatNox_Available=true;if(typeof String.prototype.trim!=="function"){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}}_ChatNox_Config.set_prefs();_ChatNox_Client_APP.start()})();function chatnox_check_promotion_rules(d){if(!d){return false}var a=d.group_condition;if(!a){a="any_one"}var e=d.rules;for(var b=0;b<e.length;b++){var c=chatnox_is_valid_rule(e[b]);_chatnox_debug_log(a+" :"+c);if(a=="any_one"&&c){return true}else{if(a=="all"&&!c){return false}else{if(a=="none"&&c){return false}}}}return true}function chatnox_is_valid_rule(e){_chatnox_debug_log(e);var g=e.LHS;var d=e.RHS;var c=e.CONDITION;if(!c||c=="all"||!d||d=="all"){return true}var a=false;switch(g){case"page_url":a=chatnox_is_valid_condition(c,document.location.href.split("?")[0],d);break;case"referer_url":var b=document.referer;b=(!b)?"":b.split("?")[0];a=chatnox_is_valid_condition(c,b,d);break;case"time_delay_on_site":a=true;break;case"visitor_type":a=chatnox_is_valid_condition(c,_ChatNox_Web_Promotions.get_default_status(),d);break;case"country":var f=_ChatNox_Config.widget_prefs;if(!f.country_code){a=true}else{a=chatnox_is_valid_condition(c,f.country_code.toLowerCase(),d.toLowerCase())}break;case"os":a=a=a=chatnox_is_valid_condition(c,BrowserDetect.OS.toLowerCase(),d.toLowerCase());break;case"browser":a=a=a=chatnox_is_valid_condition(c,BrowserDetect.browser.toLowerCase(),d.toLowerCase());break}return a}function chatnox_is_valid_condition(d,b,c){var a=false;switch(d){case"equals":a=(b==c);break;case"not_equals":a=(b!=c);break;case"starts_with":a=(b.indexOf(c)==0);break;case"contains":a=(b.indexOf(c)!=-1);break;case"match_regex":a=_ChatNox_Trigger_Conditions.match_urls(b,c);break;case"less_than":a=(b<c);break;case"greater_than":a=(b>c);break}return a}function chatnox_is_valid_promotion_frequency(e){if(e.frequency=="everytime"){return true}var c="session_frequency";var a="day_frequency";var f=e.id;var b={};var d=a;if(e.frequency=="once_per_session"){d=c}b=_ChatNox_Prefs.read_cookie(d);b=(!b)?{}:JSON.parse(b);if(b[f]){return false}b[f]=f;b=JSON.stringify(b);if(e.frequency=="once_per_session"){_ChatNox_Prefs.create_cookie(c,b)}else{_ChatNox_Prefs.create_cookie(a,b,1)}return true}var _ChatNox_Web_Promotions={web_promotions:"",filtered_promotions:"",visitor_status:"visitor_status",time_spent:"time_spent",time_spent_timer:"",start:function(){_ChatNox_Requester.send_jsonp_request("/client/client-web-promotions/prefs/"+_ChatNox_Client_APP.get_account(),{},function(a){_ChatNox_Web_Promotions.set_visitor_status();_ChatNox_Web_Promotions.add_time_spent_time_on_site();_ChatNox_Web_Promotions.web_promotions=a;_ChatNox_Web_Promotions.filter_promotions(function(){_ChatNox_Web_Promotions_Ui.show_promotion(_ChatNox_Web_Promotions.filtered_promotions[0])})})},filter_promotions:function(d){if(!this.web_promotions){return}var a=this.web_promotions,c=[];for(var b=0;b<a.length;b++){if(!this.check_valid_activity(a[b])){continue}c.push(a[b])}if(c.length==0){return}this.filtered_promotions=c;if(d){d()}},check_valid_activity:function(a){if(!a){return false}if(!a.rules){return true}if(chatnox_check_promotion_rules(a)){return true}},set_visitor_status:function(){_ChatNox_Prefs.create_cookie(this.visitor_status,this.get_default_status())},get_default_status:function(){var a=_ChatNox_Prefs.read_cookie(this.visitor_status);if(!a){a="new"}else{if(a=="new"){a="repeated"}}return a},is_new_visitor:function(){return(_ChatNox_Prefs.read_cookie(this.visitor_status)=="new")},get_domain:function(b){var d=/^https?:\/\//;var c=/^[^\/]+/;if(!b){return b}b=b.replace(d,"");var a=b.match(c);if(a){return(a[0])}return(null)},add_time_spent_time_on_site:function(){var c=_ChatNox_Prefs.read_cookie(this.time_spent);var b=this.get_domain(document.referrer);var a=this.get_domain(window.location.href);_chatnox_debug_log(b+" : "+a);if(!c||(b!=a)){c=new Date().getTime()}_ChatNox_Prefs.create_cookie(this.time_spent,c)},get_time_spent_time_on_site:function(){return _ChatNox_Prefs.read_cookie(this.time_spent)},reset_spent_time:function(){_ChatNox_Prefs.create_cookie(this.time_spent,new Date().getTime())},run_spent_timer:function(a){if(this.time_spent_timer){return}_chatnox_debug_log("run_spent_timer");this.execute_interval_timer(a)},execute_interval_timer:function(a){this.time_spent_timer=setInterval(function(){_chatnox_debug_log("setInterval "+a);if(_ChatNox_Web_Promotions_Rules_Filters.satisfy_time_spent_on_website(a.rules)){clearInterval(_ChatNox_Web_Promotions.time_spent_timer);_ChatNox_Web_Promotions_Ui.show_promotion(a)}},1000)}};var _ChatNox_Web_Promotions_Leave_Intent={init:function(){this.addEvent(document,"mouseout",function(b){b=b?b:window.event;var d=b.relatedTarget||b.toElement;if(!d||d.nodeName=="HTML"){var c=b.clientY;if(c>0||c<-50){return}_chatnox_debug_log("leave intent");var a=_ChatNox_Web_Promotions_Leave_Intent.get_promotion();_ChatNox_Web_Promotions_Ui.show_promotion(a)}})},get_promotion:function(){var a=_ChatNox_Web_Promotions.web_promotions;for(var b=0;b<a.length;b++){if(!_ChatNox_Web_Promotions_Rules_Filters.all_rules_ok(a[b],true)){continue}return a[b]}},addEvent:function(c,a,b){if(c.addEventListener){c.addEventListener(a,b,false)}else{if(c.attachEvent){c.attachEvent("on"+a,b)}}}};var _ChatNox_Web_Promotions_Rules_Filters={is_property_value_exists:function(a,b){if(!b||b[a]===undefined){return false}return true},property_array_value_check:function(a,f,b){if(!this.is_property_value_exists(a,f)){return true}var e=f[a];if(e==null||e.length==0){return true}if(b){b=b.toLowerCase()}for(var c=0;c<e.length;c++){var d=e[c];if(typeof d=="object"){if(!this.is_valid_conditions(a,d)){return false}continue}_chatnox_debug_log("target_value = "+b+" : array_val =  "+d);if(b&&d.toLowerCase()==b){return true}}return(b==undefined)},is_valid_conditions:function(a,d){if(!d||(!d.LHS&&!d.RHS)||!d.RHS){return true}if(a=="geo"){var c=_ChatNox_Config.widget_prefs.visitor_geo;if(!c.country||d.LHS==c.country){return true}}if(a=="page_url"||a=="referal_url"){var b=document.location.href,e=d.CONDITION;if(a=="referal_url"){b=document.referrer}if(!b){return true}_chatnox_debug_log("condition = "+e);if(e=="equals"||e=="match_regex"){return _ChatNox_Trigger_Conditions.match_urls(b,d.RHS)}else{if(e=="contains"){return(b.indexOf(d.RHS)>-1)}else{if(e=="not_equals"){_chatnox_debug_log(_ChatNox_Trigger_Conditions.match_urls(b,d.RHS));return !_ChatNox_Trigger_Conditions.match_urls(b,d.RHS)}else{return(b.indexOf(d.RHS)==0)}}}}},all_rules_ok:function(g,b){var h=g.rules;if(!b&&h.leave_intent_enabled){return false}else{if(b&&!h.leave_intent_enabled){return false}}var f=h.browsers_options;if(!f){f="any_one"}var c=this.property_array_value_check("browsers",h,BrowserDetect.browser);if(f=="none"&&c){return false}var d=h.operating_systems_group_condition;if(!d){d="any_one"}c=this.property_array_value_check("operating_systems",h,BrowserDetect.OS);_chatnox_debug_log("operating_systems_group_condition = "+d+" : is_valid = "+c);console.log((d=="any_one"&&!c));_chatnox_debug_log((d=="none"&&c));if((d=="none"&&c)||(d=="any_one"&&!c)){return false}var e=h.geo_group_condition;if(!e){e="any_one"}c=this.property_array_value_check("geo",h);if((e=="none"&&c)||(e=="any_one"&&!c)){return false}c=this.property_array_value_check("page_url",h);if(!c){return false}if(!this.satisfy_visitor_behaviour(h)){return false}if(!this.satisfy_time_spent_on_website(h)){var a=h.time_spent_in_session;if(a){_ChatNox_Web_Promotions.run_spent_timer(g)}return false}return true},satisfy_visitor_behaviour:function(b){var a=b.visitor_type;_chatnox_debug_log("type_of_visitor = "+a);if(!a||a=="all"){return true}else{if(a=="new"&&_ChatNox_Web_Promotions.is_new_visitor()){return true}else{if(a=="repeat"&&!_ChatNox_Web_Promotions.is_new_visitor()){return true}}}return false},satisfy_time_spent_on_website:function(d){var b=d.time_spent_in_session;_chatnox_debug_log("time_spent_in_session = "+b);if(!b){return true}var a=_ChatNox_Web_Promotions.get_time_spent_time_on_site();var c=(new Date().getTime()-Number(a));if(c>=(b*1000)){_ChatNox_Web_Promotions.reset_spent_time();return true}else{return false}}};var _ChatNox_Web_Promotions_Ui={timeout:"",closed_promotions:{},show_promotion:function(b){if(!b){return}var a=chatnox_is_valid_promotion_frequency(b);if(!a){return}if(this.isElementPresent("#promotion-"+b.id)||this.isElementPresent(".chatNoxPromotions-modal-backdrop")){return}if(_ChatNox_Web_Promotions_Ui.closed_promotions[b.id]){return}_chatnox_debug_log("show_promotion");this.load_theme_css(b);this.when_to_call(b,function(e){var c=(e.position=="middle")?"modal":"basic";document.body.appendChild(_ChatNox_Templates.get_template("promotions-"+c,e,true));_ChatNox_Web_Promotions_Ui.load_iframe(e);var d=document.getElementById("promotion-container-"+e.id);d.appendChild(_ChatNox_Templates.get_template("promotions-powered-by",{}));_ChatNox_Web_Promotions_Ui.init_events()})},load_iframe:function(c){var b=document.createElement("iframe");var e=document.getElementById("promotion-body-"+c.id);var a=BrowserDetect.browser;if(a&&a.toLowerCase()=="explorer"){e.appendChild(b);var d=(b.contentDocument||b.contentWindow.document);d.open();d.write(c.body);d.close();b.onload=function(){b.height=b.contentWindow.document.body.scrollHeight+"px";b.width=b.contentWindow.document.body.scrollWidth+12+"px";b.contentWindow.document.body.style.background="transparent";b.frameBorder=0;b.scrolling="no";if(c.position=="middle"){var f=document.getElementById("promotion-wrapper-"+c.id);f.style.left=(document.body.scrollWidth/2-b.contentWindow.document.body.scrollWidth/2)+"px"}}}else{b.onload=function(){var g=(b.contentDocument||b.contentWindow.document);g.open();g.write(c.body);g.close();b.height=b.contentWindow.document.body.scrollHeight+"px";b.width=b.contentWindow.document.body.scrollWidth+"px";b.contentWindow.document.body.style.background="transparent";b.frameBorder=0;b.scrolling="no";if(c.position=="middle"){var f=document.getElementById("promotion-wrapper-"+c.id);f.style.left=(document.body.scrollWidth/2-b.contentWindow.document.body.scrollWidth/2)+"px"}};e.appendChild(b)}},when_to_call:function(b,c){var a=b.wait_time;a=(a===undefined||a==null)?0:a;if(this.timeout){clearTimeout(this.timeout)}setTimeout(function(){c(b)},(a*1000))},load_theme_css:function(a){_ChatNox_Util.load_css_file(_ChatNox_Config.app_url+"/site/css/promotions/chatnox-base-v1.css")},init_events:function(){_ChatNox_Events.bind(".promotion-container","click",function(a){_ChatNox_Events.stop_propogation(a)});_ChatNox_Events.bind(".promotion-close","click",function(a){_ChatNox_Events.stop_propogation(a);var b=_ChatNox_Web_Promotions_Ui.get_target_ele(a,"data-id");_ChatNox_Web_Promotions_Ui.close(b)});_ChatNox_Events.bind(".chatNoxPromotions-modal-overlay","click",function(a){var b=_ChatNox_Web_Promotions_Ui.get_target_ele(a,"data-id");_ChatNox_Web_Promotions_Ui.close(b)})},get_target_ele:function(b,a){var c=(b.target)?b.target:b.srcElement;if(!c||!c.getAttribute(a)){return}return c.getAttribute(a)},close:function(b,a){if(!b){return}var d=this.get_promotion_from_id(b);if(!d||(a&&!d.hide_modal_on_overlay_click)){return}var c=document.getElementsByClassName("chatNoxPromotions")[0];this.removeEle(c);this.removeEle(document.getElementsByClassName("chatNoxPromotions-modal-backdrop")[0]);_ChatNox_Web_Promotions_Ui.closed_promotions[b]=b},get_promotion_from_id:function(c){var a=_ChatNox_Web_Promotions.web_promotions;for(var b=0;b<a.length;b++){if(a[b].id==c){return a[b]}}return null},getClosest:function(b,a){do{if(b.className===a){return b}}while(b=b.parentNode);return null},removeEle:function(a){try{a.parentNode.removeChild(a)}catch(b){}},isElementPresent:function(a){var a=_ChatNox_Events.query(a);try{if(a&&a.length>0){return(a[0].nodeName!==undefined)}}catch(b){}return false}};var _ChatNox_Web_Stickybars={sticky_bar_status:"sticky_bar_status",push_html_ele:"",start:function(){_ChatNox_Requester.send_jsonp_request("/client/client-stickybars/prefs/"+_ChatNox_Client_APP.get_account(),{},function(a){if(!a||a==null||a.length==0){return}_ChatNox_Config.stickybar_prefs=_ChatNox_Web_Stickybars.filter_data(a);if(!_ChatNox_Config.stickybar_prefs){return}_ChatNox_Util.load_css_file(_ChatNox_Config.app_url+"/site/css/stickybars/chatnox-stickybar-new.css");_ChatNox_Web_Stickybars.render_bar(_ChatNox_Config.stickybar_prefs);_ChatNox_Web_Stickybars.initialize_events()})},filter_data:function(a){if(!a){return}a=this.sort_on_url(a);for(var b=0;b<a.length;b++){var c=a[b];if(!c.page_url||_ChatNox_Web_Promotions_Rules_Filters.property_array_value_check("page_url",c)){return c}}return null},sort_on_url:function(b,a){_chatnox_debug_log("sort_on_url");_chatnox_debug_log(b);var h=new Array();for(var e=0;e<b.length;e++){var f=b[e];if(!a&&!f.page_url){continue}if(a&&!f[a].page_url){continue}var g=(a)?f[a].page_url:f.page_url;_chatnox_debug_log(g);for(var c=0;c<g.length;c++){if(g[c]["CONDITION"]=="equals"&&g[c]["RHS"]){h.push(f);break}}}_chatnox_debug_log("sorted_bars");_chatnox_debug_log(h);for(var e=0;e<b.length;e++){var d=false;for(var c=0;c<h.length;c++){if(h[c].id==b[e].id){d=true}}if(!d){h.push(b[e])}}return h},render_bar:function(b){document.body.appendChild(_ChatNox_Templates.get_template("client-stickybar",b));var a=_ChatNox_Prefs.get_prefs(_ChatNox_Web_Stickybars.sticky_bar_status);if(a!="closed"){_ChatNox_Web_Stickybars.open()}},initialize_events:function(){_ChatNox_Events.bind("#stickybar-close-btn","click",function(a){_ChatNox_Web_Stickybars.close()});_ChatNox_Events.bind("#stickybar-open-btn","click",function(a){_ChatNox_Web_Stickybars.open()});_ChatNox_Events.bind("#stickybar-email-submit-btn","click",function(b){var a=document.getElementById("chatnox-stickybar-email").value;if(!_ChatNox_Misc.is_valid_data_type_value("email",a)){document.getElementById("chatnox-stickybar-email").focus();return}_ChatNox_Requester.send_jsonp_request("/client/client-stickybars/grab-email/"+_ChatNox_Config.stickybar_prefs.id,{email:a,visitor_info:JSON.stringify(_ChatNox_Misc.visitor_info()),group_id:_ChatNox_Client_APP.get_account()},function(c){_ChatNox_Misc.remove(".stickybar-steps");document.getElementsByClassName("stickybar-content")[0].appendChild(_ChatNox_Templates.get_template("client-stickybar-success",_ChatNox_Config.stickybar_prefs))})})},close:function(){var a="closed";_ChatNox_Prefs.set_prefs(_ChatNox_Web_Stickybars.sticky_bar_status,a);_ChatNox_Chat_Ui.remove_class(".stickybar-container","stickybar-open stickybar-closed");_ChatNox_Chat_Ui.add_class(".stickybar-container","stickybar-"+a);_ChatNox_Chat_Ui.remove_class("html","chatnox-push-html-css");_ChatNox_Web_Stickybars.find_position_fixed_elements(document.body,function(b){try{_ChatNox_Chat_Ui.remove_class_to_element(b,"chatnox-push-element-css")}catch(c){}})},open:function(){var a="open";_ChatNox_Prefs.set_prefs(_ChatNox_Web_Stickybars.sticky_bar_status,a);_ChatNox_Chat_Ui.remove_class(".stickybar-container","stickybar-open stickybar-closed");_ChatNox_Chat_Ui.add_class(".stickybar-container","stickybar-"+a);_ChatNox_Chat_Ui.add_class("html","chatnox-push-html-css");_ChatNox_Web_Stickybars.find_position_fixed_elements(document.body,function(b){try{_ChatNox_Chat_Ui.add_class_to_element(b,"chatnox-push-element-css")}catch(c){}})},find_position_fixed_elements:function(c,d){if(this.push_html_ele){return d(this.push_html_ele)}if(this.compute_style(c)){return d(c)}var b=c.childNodes;for(var a=0;a<b.length;a++){if(this.compute_style(b[a])){return d(b[a])}this.find_position_fixed_elements(b[a],d)}},compute_style:function(b){try{if(this.push_html_ele){return this.push_html_ele}var a=window.getComputedStyle(b);if(((a.getPropertyValue("position")=="fixed")||(a.getPropertyValue("position")=="fixed"))&&a.getPropertyValue("top")&&b.className&&b.className.toLowerCase().indexOf("chatnox")==-1){this.push_html_ele=b;return this.push_html_ele}}catch(c){}return null}};